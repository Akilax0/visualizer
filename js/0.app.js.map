{"version":3,"sources":["webpack:///./src/js/utils/orbitControls.js","webpack:///./src/js/data/config.js","webpack:///./src/js/utils/detector.js","webpack:///./src/js/app/components/renderer.js","webpack:///./src/js/app/components/camera.js","webpack:///./src/js/app/components/light.js","webpack:///./src/js/app/components/controls.js","webpack:///./src/js/app/helpers/stats.js","webpack:///./src/js/app/helpers/vertexNormalsHelper.js","webpack:///./src/js/app/helpers/meshHelper.js","webpack:///./src/js/utils/helpers.js","webpack:///./src/js/app/model/texture.js","webpack:///./src/js/app/loaders/GLTFLoader.js","webpack:///./src/js/utils/keyboard.js","webpack:///./src/js/app/managers/interaction.js","webpack:///./src/js/app/managers/mqttClient.js","webpack:///./src/js/app/components/robot.js","webpack:///./src/js/app/main.js","webpack:///./src/js/app.js"],"names":["module","exports","THREE","MOUSE","OrbitConstraint","object","this","target","Vector3","minDistance","maxDistance","Infinity","minZoom","maxZoom","minPolarAngle","maxPolarAngle","Math","PI","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","theta","phi","v","offset","quat","quatInverse","lastPosition","lastQuaternion","scope","EPS","phiDelta","thetaDelta","scale","panOffset","zoomChanged","getPolarAngle","getAzimuthalAngle","rotateLeft","angle","rotateUp","panLeft","distance","te","matrix","elements","set","multiplyScalar","add","panUp","pan","deltaX","deltaY","screenWidth","screenHeight","PerspectiveCamera","targetDistance","position","clone","sub","length","tan","fov","OrthographicCamera","right","left","top","bottom","console","warn","dollyIn","dollyScale","zoom","max","min","updateProjectionMatrix","dollyOut","update","Quaternion","setFromUnitVectors","up","inverse","copy","applyQuaternion","atan2","x","z","sqrt","y","radius","sin","cos","lookAt","distanceToSquared","dot","quaternion","OrbitControls","domElement","constraint","undefined","document","Object","defineProperty","get","enabled","center","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","keyPanSpeed","autoRotate","autoRotateSpeed","enableKeys","keys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","ZOOM","MIDDLE","PAN","rotateStart","Vector2","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","STATE","state","target0","position0","zoom0","changeEvent","type","startEvent","endEvent","element","body","clientWidth","clientHeight","getZoomScale","pow","onMouseDown","event","preventDefault","button","clientX","clientY","addEventListener","onMouseMove","onMouseUp","dispatchEvent","subVectors","removeEventListener","onMouseWheel","stopPropagation","delta","wheelDelta","detail","onKeyDown","keyCode","touchstart","touches","pageX","pageY","dx","dy","touchmove","touchend","contextmenu","reset","dispose","window","prototype","create","EventDispatcher","constructor","defineProperties","value","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","isDev","isShowingStats","isLoaded","isTweening","isRotating","isMouseMoving","isMouseOver","maxAnisotropy","dpr","easing","TWEEN","Easing","Quadratic","InOut","duration","model","selected","initialTypes","models","path","texture","imageFiles","name","image","mesh","enableHelper","wireframe","translucent","material","color","emissive","fog","near","camera","far","aspect","posX","posY","posZ","controls","ambientLight","directionalLight","intensity","shadow","helperEnabled","bias","mapWidth","mapHeight","pointLight","hemiLight","groundColor","canvas","CanvasRenderingContext2D","webgl","createElement","WebGLRenderingContext","getContext","e","workers","Worker","fileapi","File","FileReader","FileList","Blob","getWebGLErrorMessage","id","style","fontFamily","fontSize","fontWeight","textAlign","background","padding","width","margin","innerHTML","join","addGetWebGLMessage","parameters","parent","appendChild","Renderer","scene","container","threeRenderer","antialias","setClearColor","setPixelRatio","devicePixelRatio","shadowMap","Config","capabilities","getMaxAnisotropy","updateSize","setSize","offsetWidth","offsetHeight","render","Camera","renderer","height","threeCamera","Light","init","visible","castShadow","mapSize","directionalLightHelper","lightName","Controls","orbitControls","threeControls","rS","bS","glS","tS","Stats","start","tick","frame","end","BrowserStats","glStats","threeStats","rStats","CSSPath","userTimingAPI","values","caption","over","average","avgMs","fps","below","calls","raf","rstats","groups","fractions","base","steps","plugins","_v1","_v2","_normalMatrix","Matrix3","_keys","VertexNormalsHelper","size","hex","nNormals","objGeometry","geometry","isGeometry","faces","isBufferGeometry","attributes","normal","count","BufferGeometry","positions","Float32BufferAttribute","setAttribute","LineSegments","call","LineBasicMaterial","toneMapped","matrixAutoUpdate","idx","updateMatrixWorld","getNormalMatrix","matrixWorld","vertices","i","l","face","j","jl","vertexNormals","vertex","applyMatrix4","applyMatrix3","normalize","setXYZ","objPos","objNorm","getX","getY","getZ","needsUpdate","MeshHelper","wireLine","depthTest","opacity","transparent","edges","edgesLine","vertexHelper","boxHelper","remove","Helpers","fn","threshhold","last","deferTimer","context","now","Date","args","arguments","clearTimeout","setTimeout","apply","xhr","lengthComputable","percentComplete","loaded","total","log","round","error","replace","setHex","shading","vertexColors","side","verticesNeedUpdate","normalsNeedUpdate","colorsNeedUpdate","materialKey","textures","key","Texture","loader","promiseArray","setPath","forEach","imageFile","push","Promise","resolve","reject","load","anisotropy","modelOBJ","logProgress","Error","all","then","reason","GLTFLoader","manager","Loader","dracoLoader","ddsLoader","GLTFRegistry","objects","removeAll","assign","url","onLoad","onProgress","onError","resourcePath","LoaderUtils","extractUrlBase","itemStart","_onError","itemError","itemEnd","FileLoader","setResponseType","crossOrigin","setWithCredentials","data","parse","gltf","setDRACOLoader","setDDSLoader","content","extensions","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","version","extensionsUsed","extensionName","extensionsRequired","KHR_LIGHTS_PUNCTUAL","GLTFLightsExtension","KHR_MATERIALS_CLEARCOAT","GLTFMaterialsClearcoatExtension","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","MSFT_TEXTURE_DDS","GLTFTextureDDSExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","indexOf","GLTFParser","extension","lightDefs","lights","loadLight","lightIndex","lightNode","lightDef","Color","fromArray","range","DirectionalLight","PointLight","SpotLight","spot","innerConeAngle","outerConeAngle","penumbra","decay","getMaterialType","MeshBasicMaterial","extendParams","materialParams","materialDef","parser","pending","metallicRoughness","pbrMetallicRoughness","Array","isArray","baseColorFactor","array","baseColorTexture","assignTexture","MeshPhysicalMaterial","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","clearcoatNormalScale","BINARY_EXTENSION_CHUNK_TYPES","headerView","DataView","header","magic","slice","getUint32","chunkView","chunkIndex","byteLength","chunkLength","chunkType","contentArray","byteOffset","preload","GLTFMeshStandardSGMaterial","params","MeshStandardMaterial","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","specular","glossiness","specularMap","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","defines","USE_GLOSSINESSMAP","USE_ROUGHNESSMAP","metalness","roughness","metalnessMap","roughnessMap","setValues","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","glossinessFactor","specularFactor","specularGlossinessTexture","specGlossMapDef","createMaterial","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","TangentSpaceNormalMap","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","Interpolant","decodePrimitive","primitive","bufferViewIndex","bufferView","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","getDependency","decodeDracoFile","attribute","extendTexture","transform","rotation","repeat","texCoord","source","copySampleValue_","index","result","valueSize","beforeStart_","afterEnd_","interpolate_","i1","t0","t","t1","stride","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","WEBGL_CONSTANTS","5120","Int8Array","5121","5122","Int16Array","5123","Uint16Array","5125","Uint32Array","5126","Float32Array","WEBGL_FILTERS","9728","NearestFilter","9729","LinearFilter","9984","NearestMipmapNearestFilter","9985","LinearMipmapNearestFilter","9986","NearestMipmapLinearFilter","9987","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","33071","ClampToEdgeWrapping","33648","MirroredRepeatWrapping","10497","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","MIME_TYPE_FORMATS","RGBAFormat","RGBFormat","resolveURL","test","addUnknownExtensionsToUserData","knownExtensions","objectDef","userData","gltfExtensions","assignExtrasToUserData","gltfDef","extras","updateMorphTargets","meshDef","il","morphTargetInfluences","targetNames","morphTargetDictionary","createAttributesKey","attributesKey","sort","options","cache","primitiveCache","textureLoader","TextureLoader","setCrossOrigin","fileLoader","addPrimitiveAttributes","primitiveDef","assignAttributeAccessor","accessorIndex","accessor","gltfAttributeName","indices","setIndex","box","Box3","targets","maxDisplacement","vector","setX","abs","setY","setZ","expandByVector","boundingBox","sphere","Sphere","getCenter","distanceTo","boundingSphere","computeBounds","hasMorphPosition","hasMorphNormal","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","morphPositions","morphNormals","morphAttributes","morphTargetsRelative","addMorphTargets","toTrianglesDrawMode","drawMode","getIndex","getAttribute","numberOfTriangles","newIndices","TriangleFanDrawMode","newGeometry","markDefs","getDependencies","dependencies","scenes","animations","cameras","nodeDefs","nodes","skinDefs","skins","meshDefs","meshes","meshReferences","meshUses","skinIndex","skinLength","joints","isBone","nodeIndex","nodeLength","nodeDef","skin","isSkinnedMesh","cacheKey","dependency","loadScene","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadTexture","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","uri","bufferViewDef","bufferViews","buffer","sparse","pendingBufferViews","bufferAttribute","itemSize","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","byteStride","ibSlice","floor","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","BufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setW","textureIndex","URL","self","webkitURL","textureDef","textureExtensions","sourceURI","images","isObjectURL","blob","mimeType","createObjectURL","getHandler","revokeObjectURL","flipY","format","sampler","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","isCompressedTexture","assignFinalMaterial","useVertexTangents","tangent","useVertexColors","useFlatShading","useSkinning","useMorphTargets","useMorphNormals","isPoints","uuid","pointsMaterial","PointsMaterial","Material","sizeAttenuation","isLine","lineMaterial","cachedMaterial","skinning","vertexTangents","flatShading","morphTargets","uv2","uv","materialIndex","materialType","materials","materialExtensions","sgExtension","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","doubleSided","DoubleSide","alphaMode","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","clearcoatExtension","encoding","sRGBEncoding","loadGeometries","primitives","createDracoPrimitive","dracoExtension","geometryPromise","mode","cached","promise","meshIndex","FrontSide","results","geometries","SkinnedMesh","Mesh","skinWeight","normalizeSkinWeights","TriangleStripDrawMode","Line","LineLoop","Points","group","Group","cameraIndex","cameraDef","MathUtils","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","input","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","TypedKeyframeTrack","updateMatrix","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","targetName","interpolation","traverse","isMesh","outputArray","scaled","track","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","AnimationClip","instanceNum","o","light","Bone","Object3D","PropertyBinding","sanitizeNodeName","Matrix4","buildNodeHierachy","nodeId","parentObject","pendingJoints","jointNodes","bones","boneInverses","jointNode","mat","bind","Skeleton","children","child","sceneIndex","sceneDef","nodeIds","ALIAS","Keyboard","keyCodes","onKeyChange","onBlur","prop","keyDesc","split","pressed","toUpperCase","charCodeAt","aliases","aliasKeys","shiftKey","ctrlKey","altKey","metaKey","Interaction","timeout","keyboard","throttle","onMouseLeave","onMouseOver","eventMatches","MQTTClient","robot","client_id","random","toString","substring","client","MQTT","Client","connect","userName","password","reconnect","onSuccess","subscribe","onMessageArrived","onConnectionLost","responseObject","errorCode","errorMessage","packet","msg","payloadString","trim","topic","destinationName","heading","entries","entry","r","exists","move","changeColor","R","G","B","ambient","message","callback","payload","Message","send","STLLoader","require","Robot","getObjectByName","setRGB","receiveShadow","DEG2RAD","newHeading","Tween","to","onUpdate","onComplete","delay","Main","clock","mqtt","place","stats","setUp","ground","grid","item","gui","obj","alert","meshHelper","enable","querySelector","display","requestAnimationFrame","Detector","getElementById"],"mappings":"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","file":"0.app.js","sourcesContent":["module.exports = function (THREE) {\n  var MOUSE = THREE.MOUSE;\n  if (!MOUSE) MOUSE = { LEFT: 0, MIDDLE: 1, RIGHT: 2 };\n\n  /**\n   * @author qiao / https://github.com/qiao\n   * @author mrdoob / http://mrdoob.com\n   * @author alteredq / http://alteredqualia.com/\n   * @author WestLangley / http://github.com/WestLangley\n   * @author erich666 / http://erichaines.com\n   */\n  /*global THREE, console */\n\n  function OrbitConstraint(object) {\n    this.object = object;\n\n    // \"target\" sets the location of focus, where the object orbits around\n    // and where it pans with respect to.\n    this.target = new THREE.Vector3();\n\n    // Limits to how far you can dolly in and out ( PerspectiveCamera only )\n    this.minDistance = 0;\n    this.maxDistance = Infinity;\n\n    // Limits to how far you can zoom in and out ( OrthographicCamera only )\n    this.minZoom = 0;\n    this.maxZoom = Infinity;\n\n    // How far you can orbit vertically, upper and lower limits.\n    // Range is 0 to Math.PI radians.\n    this.minPolarAngle = 0; // radians\n    this.maxPolarAngle = Math.PI; // radians\n\n    // How far you can orbit horizontally, upper and lower limits.\n    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\n    this.minAzimuthAngle = -Infinity; // radians\n    this.maxAzimuthAngle = Infinity; // radians\n\n    // Set to true to enable damping (inertia)\n    // If damping is enabled, you must call controls.update() in your animation loop\n    this.enableDamping = false;\n    this.dampingFactor = 0.25;\n\n    ////////////\n    // internals\n\n    var scope = this;\n\n    var EPS = 0.000001;\n\n    // Current position in spherical coordinate system.\n    var theta;\n    var phi;\n\n    // Pending changes\n    var phiDelta = 0;\n    var thetaDelta = 0;\n    var scale = 1;\n    var panOffset = new THREE.Vector3();\n    var zoomChanged = false;\n\n    // API\n\n    this.getPolarAngle = function () {\n      return phi;\n    };\n\n    this.getAzimuthalAngle = function () {\n      return theta;\n    };\n\n    this.rotateLeft = function (angle) {\n      thetaDelta -= angle;\n    };\n\n    this.rotateUp = function (angle) {\n      phiDelta -= angle;\n    };\n\n    // pass in distance in world space to move left\n    this.panLeft = (function () {\n      var v = new THREE.Vector3();\n\n      return function panLeft(distance) {\n        var te = this.object.matrix.elements;\n\n        // get X column of matrix\n        v.set(te[0], te[1], te[2]);\n        v.multiplyScalar(-distance);\n\n        panOffset.add(v);\n      };\n    })();\n\n    // pass in distance in world space to move up\n    this.panUp = (function () {\n      var v = new THREE.Vector3();\n\n      return function panUp(distance) {\n        var te = this.object.matrix.elements;\n\n        // get Y column of matrix\n        v.set(te[4], te[5], te[6]);\n        v.multiplyScalar(distance);\n\n        panOffset.add(v);\n      };\n    })();\n\n    // pass in x,y of change desired in pixel space,\n    // right and down are positive\n    this.pan = function (deltaX, deltaY, screenWidth, screenHeight) {\n      if (scope.object instanceof THREE.PerspectiveCamera) {\n        // perspective\n        var position = scope.object.position;\n        var offset = position.clone().sub(scope.target);\n        var targetDistance = offset.length();\n\n        // half of the fov is center to top of screen\n        targetDistance *= Math.tan(((scope.object.fov / 2) * Math.PI) / 180.0);\n\n        // we actually don't use screenWidth, since perspective camera is fixed to screen height\n        scope.panLeft((2 * deltaX * targetDistance) / screenHeight);\n        scope.panUp((2 * deltaY * targetDistance) / screenHeight);\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\n        // orthographic\n        scope.panLeft((deltaX * (scope.object.right - scope.object.left)) / screenWidth);\n        scope.panUp((deltaY * (scope.object.top - scope.object.bottom)) / screenHeight);\n      } else {\n        // camera neither orthographic or perspective\n        console.warn(\n          'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.'\n        );\n      }\n    };\n\n    this.dollyIn = function (dollyScale) {\n      if (scope.object instanceof THREE.PerspectiveCamera) {\n        scale /= dollyScale;\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\n        scope.object.zoom = Math.max(\n          this.minZoom,\n          Math.min(this.maxZoom, this.object.zoom * dollyScale)\n        );\n        scope.object.updateProjectionMatrix();\n        zoomChanged = true;\n      } else {\n        console.warn(\n          'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'\n        );\n      }\n    };\n\n    this.dollyOut = function (dollyScale) {\n      if (scope.object instanceof THREE.PerspectiveCamera) {\n        scale *= dollyScale;\n      } else if (scope.object instanceof THREE.OrthographicCamera) {\n        scope.object.zoom = Math.max(\n          this.minZoom,\n          Math.min(this.maxZoom, this.object.zoom / dollyScale)\n        );\n        scope.object.updateProjectionMatrix();\n        zoomChanged = true;\n      } else {\n        console.warn(\n          'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.'\n        );\n      }\n    };\n\n    this.update = (function () {\n      var offset = new THREE.Vector3();\n\n      // so camera.up is the orbit axis\n      var quat = new THREE.Quaternion().setFromUnitVectors(object.up, new THREE.Vector3(0, 1, 0));\n      var quatInverse = quat.clone().inverse();\n\n      var lastPosition = new THREE.Vector3();\n      var lastQuaternion = new THREE.Quaternion();\n\n      return function () {\n        var position = this.object.position;\n\n        offset.copy(position).sub(this.target);\n\n        // rotate offset to \"y-axis-is-up\" space\n        offset.applyQuaternion(quat);\n\n        // angle from z-axis around y-axis\n\n        theta = Math.atan2(offset.x, offset.z);\n\n        // angle from y-axis\n\n        phi = Math.atan2(Math.sqrt(offset.x * offset.x + offset.z * offset.z), offset.y);\n\n        theta += thetaDelta;\n        phi += phiDelta;\n\n        // restrict theta to be between desired limits\n        theta = Math.max(this.minAzimuthAngle, Math.min(this.maxAzimuthAngle, theta));\n\n        // restrict phi to be between desired limits\n        phi = Math.max(this.minPolarAngle, Math.min(this.maxPolarAngle, phi));\n\n        // restrict phi to be betwee EPS and PI-EPS\n        phi = Math.max(EPS, Math.min(Math.PI - EPS, phi));\n\n        var radius = offset.length() * scale;\n\n        // restrict radius to be between desired limits\n        radius = Math.max(this.minDistance, Math.min(this.maxDistance, radius));\n\n        // move target to panned location\n        this.target.add(panOffset);\n\n        offset.x = radius * Math.sin(phi) * Math.sin(theta);\n        offset.y = radius * Math.cos(phi);\n        offset.z = radius * Math.sin(phi) * Math.cos(theta);\n\n        // rotate offset back to \"camera-up-vector-is-up\" space\n        offset.applyQuaternion(quatInverse);\n\n        position.copy(this.target).add(offset);\n\n        this.object.lookAt(this.target);\n\n        if (this.enableDamping === true) {\n          thetaDelta *= 1 - this.dampingFactor;\n          phiDelta *= 1 - this.dampingFactor;\n        } else {\n          thetaDelta = 0;\n          phiDelta = 0;\n        }\n\n        scale = 1;\n        panOffset.set(0, 0, 0);\n\n        // update condition is:\n        // min(camera displacement, camera rotation in radians)^2 > EPS\n        // using small-angle approximation cos(x/2) = 1 - x^2 / 8\n\n        if (\n          zoomChanged ||\n          lastPosition.distanceToSquared(this.object.position) > EPS ||\n          8 * (1 - lastQuaternion.dot(this.object.quaternion)) > EPS\n        ) {\n          lastPosition.copy(this.object.position);\n          lastQuaternion.copy(this.object.quaternion);\n          zoomChanged = false;\n\n          return true;\n        }\n\n        return false;\n      };\n    })();\n  }\n\n  // This set of controls performs orbiting, dollying (zooming), and panning. It maintains\n  // the \"up\" direction as +Y, unlike the TrackballControls. Touch on tablet and phones is\n  // supported.\n  //\n  //    Orbit - left mouse / touch: one finger move\n  //    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\n  //    Pan - right mouse, or arrow keys / touch: three finter swipe\n\n  function OrbitControls(object, domElement) {\n    var constraint = new OrbitConstraint(object);\n\n    this.domElement = domElement !== undefined ? domElement : document;\n\n    // API\n\n    Object.defineProperty(this, 'constraint', {\n      get: function () {\n        return constraint;\n      },\n    });\n\n    this.getPolarAngle = function () {\n      return constraint.getPolarAngle();\n    };\n\n    this.getAzimuthalAngle = function () {\n      return constraint.getAzimuthalAngle();\n    };\n\n    // Set to false to disable this control\n    this.enabled = true;\n\n    // center is old, deprecated; use \"target\" instead\n    this.center = this.target;\n\n    // This option actually enables dollying in and out; left as \"zoom\" for\n    // backwards compatibility.\n    // Set to false to disable zooming\n    this.enableZoom = true;\n    this.zoomSpeed = 1.0;\n\n    // Set to false to disable rotating\n    this.enableRotate = true;\n    this.rotateSpeed = 1.0;\n\n    // Set to false to disable panning\n    this.enablePan = true;\n    this.keyPanSpeed = 7.0; // pixels moved per arrow key push\n\n    // Set to true to automatically rotate around the target\n    // If auto-rotate is enabled, you must call controls.update() in your animation loop\n    this.autoRotate = false;\n    this.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\n\n    // Set to false to disable use of the keys\n    this.enableKeys = true;\n\n    // The four arrow keys\n    this.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\n\n    // Mouse buttons\n    this.mouseButtons = {\n      ORBIT: THREE.MOUSE.LEFT,\n      ZOOM: THREE.MOUSE.MIDDLE,\n      PAN: THREE.MOUSE.RIGHT,\n    };\n\n    ////////////\n    // internals\n\n    var scope = this;\n\n    var rotateStart = new THREE.Vector2();\n    var rotateEnd = new THREE.Vector2();\n    var rotateDelta = new THREE.Vector2();\n\n    var panStart = new THREE.Vector2();\n    var panEnd = new THREE.Vector2();\n    var panDelta = new THREE.Vector2();\n\n    var dollyStart = new THREE.Vector2();\n    var dollyEnd = new THREE.Vector2();\n    var dollyDelta = new THREE.Vector2();\n\n    var STATE = {\n      NONE: -1,\n      ROTATE: 0,\n      DOLLY: 1,\n      PAN: 2,\n      TOUCH_ROTATE: 3,\n      TOUCH_DOLLY: 4,\n      TOUCH_PAN: 5,\n    };\n\n    var state = STATE.NONE;\n\n    // for reset\n\n    this.target0 = this.target.clone();\n    this.position0 = this.object.position.clone();\n    this.zoom0 = this.object.zoom;\n\n    // events\n\n    var changeEvent = { type: 'change' };\n    var startEvent = { type: 'start' };\n    var endEvent = { type: 'end' };\n\n    // pass in x,y of change desired in pixel space,\n    // right and down are positive\n    function pan(deltaX, deltaY) {\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n      constraint.pan(deltaX, deltaY, element.clientWidth, element.clientHeight);\n    }\n\n    this.update = function () {\n      if (this.autoRotate && state === STATE.NONE) {\n        constraint.rotateLeft(getAutoRotationAngle());\n      }\n\n      if (constraint.update() === true) {\n        this.dispatchEvent(changeEvent);\n      }\n    };\n\n    this.reset = function () {\n      state = STATE.NONE;\n\n      this.target.copy(this.target0);\n      this.object.position.copy(this.position0);\n      this.object.zoom = this.zoom0;\n\n      this.object.updateProjectionMatrix();\n      this.dispatchEvent(changeEvent);\n\n      this.update();\n    };\n\n    function getAutoRotationAngle() {\n      return ((2 * Math.PI) / 60 / 60) * scope.autoRotateSpeed;\n    }\n\n    function getZoomScale() {\n      return Math.pow(0.95, scope.zoomSpeed);\n    }\n\n    function onMouseDown(event) {\n      if (scope.enabled === false) return;\n\n      event.preventDefault();\n\n      if (event.button === scope.mouseButtons.ORBIT) {\n        if (scope.enableRotate === false) return;\n\n        state = STATE.ROTATE;\n\n        rotateStart.set(event.clientX, event.clientY);\n      } else if (event.button === scope.mouseButtons.ZOOM) {\n        if (scope.enableZoom === false) return;\n\n        state = STATE.DOLLY;\n\n        dollyStart.set(event.clientX, event.clientY);\n      } else if (event.button === scope.mouseButtons.PAN) {\n        if (scope.enablePan === false) return;\n\n        state = STATE.PAN;\n\n        panStart.set(event.clientX, event.clientY);\n      }\n\n      if (state !== STATE.NONE) {\n        document.addEventListener('mousemove', onMouseMove, false);\n        document.addEventListener('mouseup', onMouseUp, false);\n        scope.dispatchEvent(startEvent);\n      }\n    }\n\n    function onMouseMove(event) {\n      if (scope.enabled === false) return;\n\n      event.preventDefault();\n\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n      if (state === STATE.ROTATE) {\n        if (scope.enableRotate === false) return;\n\n        rotateEnd.set(event.clientX, event.clientY);\n        rotateDelta.subVectors(rotateEnd, rotateStart);\n\n        // rotating across whole screen goes 360 degrees around\n        constraint.rotateLeft(\n          ((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed\n        );\n\n        // rotating up and down along whole screen attempts to go 360, but limited to 180\n        constraint.rotateUp(\n          ((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed\n        );\n\n        rotateStart.copy(rotateEnd);\n      } else if (state === STATE.DOLLY) {\n        if (scope.enableZoom === false) return;\n\n        dollyEnd.set(event.clientX, event.clientY);\n        dollyDelta.subVectors(dollyEnd, dollyStart);\n\n        if (dollyDelta.y > 0) {\n          constraint.dollyIn(getZoomScale());\n        } else if (dollyDelta.y < 0) {\n          constraint.dollyOut(getZoomScale());\n        }\n\n        dollyStart.copy(dollyEnd);\n      } else if (state === STATE.PAN) {\n        if (scope.enablePan === false) return;\n\n        panEnd.set(event.clientX, event.clientY);\n        panDelta.subVectors(panEnd, panStart);\n\n        pan(panDelta.x, panDelta.y);\n\n        panStart.copy(panEnd);\n      }\n\n      if (state !== STATE.NONE) scope.update();\n    }\n\n    function onMouseUp(/* event */) {\n      if (scope.enabled === false) return;\n\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('mouseup', onMouseUp, false);\n      scope.dispatchEvent(endEvent);\n      state = STATE.NONE;\n    }\n\n    function onMouseWheel(event) {\n      if (scope.enabled === false || scope.enableZoom === false || state !== STATE.NONE) return;\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      var delta = 0;\n\n      if (event.wheelDelta !== undefined) {\n        // WebKit / Opera / Explorer 9\n\n        delta = event.wheelDelta;\n      } else if (event.detail !== undefined) {\n        // Firefox\n\n        delta = -event.detail;\n      }\n\n      if (delta > 0) {\n        constraint.dollyOut(getZoomScale());\n      } else if (delta < 0) {\n        constraint.dollyIn(getZoomScale());\n      }\n\n      scope.update();\n      scope.dispatchEvent(startEvent);\n      scope.dispatchEvent(endEvent);\n    }\n\n    function onKeyDown(event) {\n      if (scope.enabled === false || scope.enableKeys === false || scope.enablePan === false)\n        return;\n\n      switch (event.keyCode) {\n        case scope.keys.UP:\n          pan(0, scope.keyPanSpeed);\n          scope.update();\n          break;\n\n        case scope.keys.BOTTOM:\n          pan(0, -scope.keyPanSpeed);\n          scope.update();\n          break;\n\n        case scope.keys.LEFT:\n          pan(scope.keyPanSpeed, 0);\n          scope.update();\n          break;\n\n        case scope.keys.RIGHT:\n          pan(-scope.keyPanSpeed, 0);\n          scope.update();\n          break;\n      }\n    }\n\n    function touchstart(event) {\n      if (scope.enabled === false) return;\n\n      switch (event.touches.length) {\n        case 1: // one-fingered touch: rotate\n          if (scope.enableRotate === false) return;\n\n          state = STATE.TOUCH_ROTATE;\n\n          rotateStart.set(event.touches[0].pageX, event.touches[0].pageY);\n          break;\n\n        case 2: // two-fingered touch: dolly\n          if (scope.enableZoom === false) return;\n\n          state = STATE.TOUCH_DOLLY;\n\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\n          var distance = Math.sqrt(dx * dx + dy * dy);\n          dollyStart.set(0, distance);\n          break;\n\n        case 3: // three-fingered touch: pan\n          if (scope.enablePan === false) return;\n\n          state = STATE.TOUCH_PAN;\n\n          panStart.set(event.touches[0].pageX, event.touches[0].pageY);\n          break;\n\n        default:\n          state = STATE.NONE;\n      }\n\n      if (state !== STATE.NONE) scope.dispatchEvent(startEvent);\n    }\n\n    function touchmove(event) {\n      if (scope.enabled === false) return;\n\n      event.preventDefault();\n      event.stopPropagation();\n\n      var element = scope.domElement === document ? scope.domElement.body : scope.domElement;\n\n      switch (event.touches.length) {\n        case 1: // one-fingered touch: rotate\n          if (scope.enableRotate === false) return;\n          if (state !== STATE.TOUCH_ROTATE) return;\n\n          rotateEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n          rotateDelta.subVectors(rotateEnd, rotateStart);\n\n          // rotating across whole screen goes 360 degrees around\n          constraint.rotateLeft(\n            ((2 * Math.PI * rotateDelta.x) / element.clientWidth) * scope.rotateSpeed\n          );\n          // rotating up and down along whole screen attempts to go 360, but limited to 180\n          constraint.rotateUp(\n            ((2 * Math.PI * rotateDelta.y) / element.clientHeight) * scope.rotateSpeed\n          );\n\n          rotateStart.copy(rotateEnd);\n\n          scope.update();\n          break;\n\n        case 2: // two-fingered touch: dolly\n          if (scope.enableZoom === false) return;\n          if (state !== STATE.TOUCH_DOLLY) return;\n\n          var dx = event.touches[0].pageX - event.touches[1].pageX;\n          var dy = event.touches[0].pageY - event.touches[1].pageY;\n          var distance = Math.sqrt(dx * dx + dy * dy);\n\n          dollyEnd.set(0, distance);\n          dollyDelta.subVectors(dollyEnd, dollyStart);\n\n          if (dollyDelta.y > 0) {\n            constraint.dollyOut(getZoomScale());\n          } else if (dollyDelta.y < 0) {\n            constraint.dollyIn(getZoomScale());\n          }\n\n          dollyStart.copy(dollyEnd);\n\n          scope.update();\n          break;\n\n        case 3: // three-fingered touch: pan\n          if (scope.enablePan === false) return;\n          if (state !== STATE.TOUCH_PAN) return;\n\n          panEnd.set(event.touches[0].pageX, event.touches[0].pageY);\n          panDelta.subVectors(panEnd, panStart);\n\n          pan(panDelta.x, panDelta.y);\n\n          panStart.copy(panEnd);\n\n          scope.update();\n          break;\n\n        default:\n          state = STATE.NONE;\n      }\n    }\n\n    function touchend(/* event */) {\n      if (scope.enabled === false) return;\n\n      scope.dispatchEvent(endEvent);\n      state = STATE.NONE;\n    }\n\n    function contextmenu(event) {\n      event.preventDefault();\n    }\n\n    this.dispose = function () {\n      this.domElement.removeEventListener('contextmenu', contextmenu, false);\n      this.domElement.removeEventListener('mousedown', onMouseDown, false);\n      this.domElement.removeEventListener('mousewheel', onMouseWheel, false);\n      this.domElement.removeEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\n      this.domElement.removeEventListener('touchstart', touchstart, false);\n      this.domElement.removeEventListener('touchend', touchend, false);\n      this.domElement.removeEventListener('touchmove', touchmove, false);\n\n      document.removeEventListener('mousemove', onMouseMove, false);\n      document.removeEventListener('mouseup', onMouseUp, false);\n\n      window.removeEventListener('keydown', onKeyDown, false);\n    };\n\n    this.domElement.addEventListener('contextmenu', contextmenu, false);\n\n    this.domElement.addEventListener('mousedown', onMouseDown, false);\n    this.domElement.addEventListener('mousewheel', onMouseWheel, false);\n    this.domElement.addEventListener('MozMousePixelScroll', onMouseWheel, false); // firefox\n\n    this.domElement.addEventListener('touchstart', touchstart, false);\n    this.domElement.addEventListener('touchend', touchend, false);\n    this.domElement.addEventListener('touchmove', touchmove, false);\n\n    window.addEventListener('keydown', onKeyDown, false);\n\n    // force an update at start\n    this.update();\n  }\n\n  OrbitControls.prototype = Object.create(THREE.EventDispatcher.prototype);\n  OrbitControls.prototype.constructor = OrbitControls;\n\n  Object.defineProperties(OrbitControls.prototype, {\n    object: {\n      get: function () {\n        return this.constraint.object;\n      },\n    },\n\n    target: {\n      get: function () {\n        return this.constraint.target;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: target is now immutable. Use target.set() instead.');\n        this.constraint.target.copy(value);\n      },\n    },\n\n    minDistance: {\n      get: function () {\n        return this.constraint.minDistance;\n      },\n\n      set: function (value) {\n        this.constraint.minDistance = value;\n      },\n    },\n\n    maxDistance: {\n      get: function () {\n        return this.constraint.maxDistance;\n      },\n\n      set: function (value) {\n        this.constraint.maxDistance = value;\n      },\n    },\n\n    minZoom: {\n      get: function () {\n        return this.constraint.minZoom;\n      },\n\n      set: function (value) {\n        this.constraint.minZoom = value;\n      },\n    },\n\n    maxZoom: {\n      get: function () {\n        return this.constraint.maxZoom;\n      },\n\n      set: function (value) {\n        this.constraint.maxZoom = value;\n      },\n    },\n\n    minPolarAngle: {\n      get: function () {\n        return this.constraint.minPolarAngle;\n      },\n\n      set: function (value) {\n        this.constraint.minPolarAngle = value;\n      },\n    },\n\n    maxPolarAngle: {\n      get: function () {\n        return this.constraint.maxPolarAngle;\n      },\n\n      set: function (value) {\n        this.constraint.maxPolarAngle = value;\n      },\n    },\n\n    minAzimuthAngle: {\n      get: function () {\n        return this.constraint.minAzimuthAngle;\n      },\n\n      set: function (value) {\n        this.constraint.minAzimuthAngle = value;\n      },\n    },\n\n    maxAzimuthAngle: {\n      get: function () {\n        return this.constraint.maxAzimuthAngle;\n      },\n\n      set: function (value) {\n        this.constraint.maxAzimuthAngle = value;\n      },\n    },\n\n    enableDamping: {\n      get: function () {\n        return this.constraint.enableDamping;\n      },\n\n      set: function (value) {\n        this.constraint.enableDamping = value;\n      },\n    },\n\n    dampingFactor: {\n      get: function () {\n        return this.constraint.dampingFactor;\n      },\n\n      set: function (value) {\n        this.constraint.dampingFactor = value;\n      },\n    },\n\n    // backward compatibility\n\n    noZoom: {\n      get: function () {\n        console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n        return !this.enableZoom;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.');\n        this.enableZoom = !value;\n      },\n    },\n\n    noRotate: {\n      get: function () {\n        console.warn(\n          'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'\n        );\n        return !this.enableRotate;\n      },\n\n      set: function (value) {\n        console.warn(\n          'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.'\n        );\n        this.enableRotate = !value;\n      },\n    },\n\n    noPan: {\n      get: function () {\n        console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n        return !this.enablePan;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.');\n        this.enablePan = !value;\n      },\n    },\n\n    noKeys: {\n      get: function () {\n        console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n        return !this.enableKeys;\n      },\n\n      set: function (value) {\n        console.warn('THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.');\n        this.enableKeys = !value;\n      },\n    },\n\n    staticMoving: {\n      get: function () {\n        console.warn(\n          'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'\n        );\n        return !this.constraint.enableDamping;\n      },\n\n      set: function (value) {\n        console.warn(\n          'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.'\n        );\n        this.constraint.enableDamping = !value;\n      },\n    },\n\n    dynamicDampingFactor: {\n      get: function () {\n        console.warn(\n          'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\n        );\n        return this.constraint.dampingFactor;\n      },\n\n      set: function (value) {\n        console.warn(\n          'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.'\n        );\n        this.constraint.dampingFactor = value;\n      },\n    },\n  });\n\n  return OrbitControls;\n};\n","import TWEEN from '@tweenjs/tween.js';\n\n// This object contains the state of the app\nexport default {\n  isDev: true,\n  isShowingStats: false,\n  isLoaded: false,\n  isTweening: false,\n  isRotating: false,\n  isMouseMoving: false,\n  isMouseOver: false,\n  maxAnisotropy: 1,\n  dpr: 1,\n  easing: TWEEN.Easing.Quadratic.InOut,\n  duration: 500,\n  model: {\n    selected: 0,\n    initialTypes: ['gltf'],\n    type: 'gltf'\n  },\n  models: [\n    {\n      path: './assets/models/duck.gltf',\n      scale: 20,\n      type: 'gltf'\n    },\n  ],\n  texture: {\n    path: './assets/textures/',\n    imageFiles: [\n      { name: 'UV', image: 'UV_Grid_Sm.jpg' }\n    ]\n  },\n  mesh: {\n    enableHelper: false,\n    wireframe: false,\n    translucent: false,\n    material: {\n      color: 0xffffff,\n      emissive: 0xffffff\n    }\n  },\n  fog: {\n    color: 0xffffff,\n    near: 0.0008\n  },\n  camera: {\n    fov: 40,\n    near: 100,\n    far: 1000,\n    aspect: 1,\n    posX: 0,\n    posY: 0,\n    posZ: 0\n  },\n  controls: {\n    autoRotate: false,\n    autoRotateSpeed: -0.5,\n    rotateSpeed: 0.5,\n    zoomSpeed: 0.8,\n    minDistance: 200,\n    maxDistance: 800,\n    minPolarAngle: 0, /*Math.PI / 5,*/\n    maxPolarAngle: Math.PI / 2,\n    minAzimuthAngle: -Infinity,\n    maxAzimuthAngle: Infinity,\n    enableDamping: true,\n    dampingFactor: 0.5,\n    enableZoom: true,\n    target: {\n      x: 0,\n      y: 0,\n      z: 0\n    }\n  },\n  ambientLight: {\n    enabled: true,\n    color: 0x141414\n  },\n  directionalLight: {\n    enabled: true,\n    color: 0xf0f0f0,\n    intensity: 0.4,\n    x: -75,\n    y: 280,\n    z: 150\n  },\n  shadow: {\n    enabled: true,\n    helperEnabled: false,\n    bias: 0,\n    mapWidth: 2048,\n    mapHeight: 2048,\n    near: 250,\n    far: 400,\n    top: 100,\n    right: 100,\n    bottom: -100,\n    left: -100\n  },\n  pointLight: {\n    enabled: true,\n    color: 0xffffff,\n    intensity: 0.34,\n    distance: 115,\n    x: 0,\n    y: 0,\n    z: 0\n  },\n  hemiLight: {\n    enabled: true,\n    color: 0xc8c8c8,\n    groundColor: 0xffffff,\n    intensity: 0.55,\n    x: 0,\n    y: 0,\n    z: 0\n  }\n};\n","/**\n * @author alteredq / http://alteredqualia.com/\n * @author mr.doob / http://mrdoob.com/\n */\n\nexport default {\n  canvas: !!window.CanvasRenderingContext2D,\n  webgl: (function() {\n    try {\n      var canvas = document.createElement('canvas');\n\n      return !!(window.WebGLRenderingContext && (canvas.getContext('webgl') || canvas.getContext('experimental-webgl')));\n    } catch(e) {\n      return false;\n    }\n  })(),\n\n  workers: !!window.Worker,\n  fileapi: window.File && window.FileReader && window.FileList && window.Blob,\n\n  getWebGLErrorMessage: function() {\n    var element = document.createElement('div');\n    element.id = 'webgl-error-message';\n    element.style.fontFamily = 'monospace';\n    element.style.fontSize = '13px';\n    element.style.fontWeight = 'normal';\n    element.style.textAlign = 'center';\n    element.style.background = '#fff';\n    element.style.color = '#000';\n    element.style.padding = '1.5em';\n    element.style.width = '400px';\n    element.style.margin = '5em auto 0';\n\n    if(!this.webgl) {\n      element.innerHTML = window.WebGLRenderingContext ? [\n        'Your graphics card does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br />',\n        'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n      ].join('\\n') : [\n        'Your browser does not seem to support <a href=\"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation\" style=\"color:#000000\">WebGL</a>.<br/>',\n        'Find out how to get it <a href=\"http://get.webgl.org/\" style=\"color:#000000\">here</a>.'\n      ].join('\\n');\n    }\n\n    return element;\n  },\n\n  addGetWebGLMessage: function(parameters) {\n    var parent, id, element;\n\n    parameters = parameters || {};\n\n    parent = parameters.parent !== undefined ? parameters.parent : document.body;\n    id = parameters.id !== undefined ? parameters.id : 'oldie';\n\n    element = this.getWebGLErrorMessage();\n    element.id = id;\n\n    parent.appendChild(element);\n  }\n};\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Main webGL renderer class\nexport default class Renderer {\n   constructor(scene, container) {\n      // Properties\n      this.scene = scene;\n      this.container = container;\n\n      // Create WebGL renderer and set its antialias\n      this.threeRenderer = new THREE.WebGLRenderer({antialias: true});\n\n      // Set clear color to fog to enable fog or to hex color for no fog\n      this.threeRenderer.setClearColor(scene.fog.color);\n      this.threeRenderer.setPixelRatio(window.devicePixelRatio); // For retina\n\n      // Appends canvas\n      container.appendChild(this.threeRenderer.domElement);\n\n      // Shadow map options\n      this.threeRenderer.shadowMap.enabled = true;\n      this.threeRenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\n      // Get anisotropy for textures\n      Config.maxAnisotropy = this.threeRenderer.capabilities.getMaxAnisotropy();\n\n      // Initial size update set to canvas container\n      this.updateSize();\n\n      // Listeners\n      document.addEventListener('DOMContentLoaded', () => this.updateSize(), false);\n      window.addEventListener('resize', () => this.updateSize(), false);\n   }\n\n   updateSize() {\n      this.threeRenderer.setSize(this.container.offsetWidth, this.container.offsetHeight);\n   }\n\n   render(scene, camera) {\n      // Renders scene to canvas target\n      this.threeRenderer.render(scene, camera);\n   }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Class that creates and updates the main camera\nexport default class Camera {\n  constructor(renderer) {\n    const width = renderer.domElement.width;\n    const height = renderer.domElement.height;\n\n    // Create and position a Perspective Camera\n    this.threeCamera = new THREE.PerspectiveCamera(Config.camera.fov, width / height, Config.camera.near, Config.camera.far);\n    this.threeCamera.position.set(Config.camera.posX, Config.camera.posY, Config.camera.posZ);\n\n    // Initial sizing\n    this.updateSize(renderer);\n    \n    // Listeners\n    window.addEventListener('resize', () => this.updateSize(renderer), false);\n  }\n\n  updateSize(renderer) {\n    // Update camera aspect ratio with window aspect ratio\n    this.threeCamera.aspect = renderer.domElement.width / renderer.domElement.height;\n\n    // Always call updateProjectionMatrix on camera change\n    this.threeCamera.updateProjectionMatrix();\n  }\n}\n","import * as THREE from 'three';\n\nimport Config from '../../data/config';\n\n// Sets up and places all lights in scene\nexport default class Light {\n  constructor(scene) {\n    this.scene = scene;\n\n    this.init();\n  }\n\n  init() {\n    // Ambient\n    this.ambientLight = new THREE.AmbientLight(Config.ambientLight.color);\n    this.ambientLight.visible = Config.ambientLight.enabled;\n\n    // Point light\n    this.pointLight = new THREE.PointLight(Config.pointLight.color, Config.pointLight.intensity, Config.pointLight.distance);\n    this.pointLight.position.set(Config.pointLight.x, Config.pointLight.y, Config.pointLight.z);\n    this.pointLight.visible = Config.pointLight.enabled;\n\n    // Directional light\n    this.directionalLight = new THREE.DirectionalLight(Config.directionalLight.color, Config.directionalLight.intensity);\n    this.directionalLight.position.set(Config.directionalLight.x, Config.directionalLight.y, Config.directionalLight.z);\n    this.directionalLight.visible = Config.directionalLight.enabled;\n\n    // Shadow map\n    this.directionalLight.castShadow = Config.shadow.enabled;\n    this.directionalLight.shadow.bias = Config.shadow.bias;\n    this.directionalLight.shadow.camera.near = Config.shadow.near;\n    this.directionalLight.shadow.camera.far = Config.shadow.far;\n    this.directionalLight.shadow.camera.left = Config.shadow.left;\n    this.directionalLight.shadow.camera.right = Config.shadow.right;\n    this.directionalLight.shadow.camera.top = Config.shadow.top;\n    this.directionalLight.shadow.camera.bottom = Config.shadow.bottom;\n    this.directionalLight.shadow.mapSize.width = Config.shadow.mapWidth;\n    this.directionalLight.shadow.mapSize.height = Config.shadow.mapHeight;\n\n    // Shadow camera helper\n    this.directionalLightHelper = new THREE.CameraHelper(this.directionalLight.shadow.camera);\n    this.directionalLightHelper.visible = Config.shadow.helperEnabled;\n\n    // Hemisphere light\n    this.hemiLight = new THREE.HemisphereLight(Config.hemiLight.color, Config.hemiLight.groundColor, Config.hemiLight.intensity);\n    this.hemiLight.position.set(Config.hemiLight.x, Config.hemiLight.y, Config.hemiLight.z);\n    this.hemiLight.visible = Config.hemiLight.enabled;\n  }\n\n  place(lightName) {\n    switch(lightName) {\n      case 'ambient':\n        this.scene.add(this.ambientLight);\n        break;\n\n      case 'directional':\n        this.scene.add(this.directionalLight);\n        this.scene.add(this.directionalLightHelper);\n        break;\n\n      case 'point':\n        this.scene.add(this.pointLight);\n        break;\n\n      case 'hemi':\n        this.scene.add(this.hemiLight);\n        break;\n    }\n  }\n}\n","import * as THREE from 'three';\n\nimport OrbitControls from '../../utils/orbitControls';\nimport Config from '../../data/config';\n\n// Controls based on orbit controls\nexport default class Controls {\n  constructor(camera, container) {\n    // Orbit controls first needs to pass in THREE to constructor\n    const orbitControls = new OrbitControls(THREE);\n    this.threeControls = new orbitControls(camera, container);\n\n    this.init();\n  }\n\n  init() {\n    this.threeControls.target.set(Config.controls.target.x, Config.controls.target.y, Config.controls.target.z);\n    this.threeControls.autoRotate = Config.controls.autoRotate;\n    this.threeControls.autoRotateSpeed = Config.controls.autoRotateSpeed;\n    this.threeControls.rotateSpeed = Config.controls.rotateSpeed;\n    this.threeControls.zoomSpeed = Config.controls.zoomSpeed;\n    this.threeControls.minDistance = Config.controls.minDistance;\n    this.threeControls.maxDistance = Config.controls.maxDistance;\n    this.threeControls.minPolarAngle = Config.controls.minPolarAngle;\n    this.threeControls.maxPolarAngle = Config.controls.maxPolarAngle;\n    this.threeControls.enableDamping = Config.controls.enableDamping;\n    this.threeControls.enableZoom = Config.controls.enableZoom;\n    this.threeControls.dampingFactor = Config.controls.dampingFactor;\n  }\n}\n","// Local vars for rStats\nlet rS, bS, glS, tS;\n\nexport default class Stats {\n  constructor(renderer) {\n    this.renderer = renderer;\n  }\n\n  setUp() {\n    bS = new BrowserStats();\n    glS = new glStats();\n    tS = new threeStats(this.renderer.threeRenderer);\n\n    rS = new rStats({\n      CSSPath: './css/',\n      userTimingAPI: true,\n      values: {\n        frame: { caption: 'Total frame time (ms)', over: 16, average: true, avgMs: 100 },\n        fps: { caption: 'Framerate (FPS)', below: 30 },\n        calls: { caption: 'Calls (three.js)', over: 3000 },\n        raf: { caption: 'Time since last rAF (ms)', average: true, avgMs: 100 },\n        rstats: { caption: 'rStats update (ms)', average: true, avgMs: 100 },\n        texture: { caption: 'GenTex', average: true, avgMs: 100 }\n      },\n      groups: [\n        { caption: 'Framerate', values: ['fps', 'raf'] },\n        { caption: 'Frame Budget', values: ['frame', 'texture', 'setup', 'render'] }\n      ],\n      fractions: [\n        { base: 'frame', steps: ['texture', 'setup', 'render'] }\n      ],\n      plugins: [bS, tS]\n    });\n  }\n\n  static start() {\n    rS('frame').start();\n    glS.start();\n\n    rS('rAF').tick();\n    rS('FPS').frame();\n\n    rS('render').start();\n  }\n\n  static end() {\n    rS('render').end(); // render finished\n    rS('frame').end(); // frame finished\n\n    // Local rStats update\n    rS('rStats').start();\n    rS().update();\n    rS('rStats').end();\n  }\n}\n","/**\n * @author mrdoob / http://mrdoob.com/\n * @author WestLangley / http://github.com/WestLangley\n */\n\nimport {\n  BufferGeometry,\n  Float32BufferAttribute,\n  LineSegments,\n  LineBasicMaterial,\n  Matrix3,\n  Vector3,\n} from 'three';\n\nconst _v1 = new Vector3();\nconst _v2 = new Vector3();\nconst _normalMatrix = new Matrix3();\nconst _keys = ['a', 'b', 'c'];\n\nfunction VertexNormalsHelper(object, size, hex) {\n  this.object = object;\n  this.size = size !== undefined ? size : 0.1;\n\n  const color = hex !== undefined ? hex : 0xff0000;\n\n  //\n\n  let nNormals = 0;\n\n  const objGeometry = this.object.geometry;\n\n  if (objGeometry && objGeometry.isGeometry) {\n    nNormals = objGeometry.faces.length * 3;\n  } else if (objGeometry && objGeometry.isBufferGeometry) {\n    nNormals = objGeometry.attributes.normal.count;\n  }\n\n  //\n\n  const geometry = new BufferGeometry();\n  const positions = new Float32BufferAttribute(nNormals * 2 * 3, 3);\n\n  geometry.setAttribute('position', positions);\n\n  LineSegments.call(this, geometry, new LineBasicMaterial({ color: color, toneMapped: false }));\n\n  this.type = 'VertexNormalsHelper';\n\n  //\n\n  this.matrixAutoUpdate = false;\n\n  this.update();\n}\n\nVertexNormalsHelper.prototype = Object.create(LineSegments.prototype);\nVertexNormalsHelper.prototype.constructor = VertexNormalsHelper;\n\nVertexNormalsHelper.prototype.update = function () {\n  let idx;\n  this.object.updateMatrixWorld(true);\n\n  _normalMatrix.getNormalMatrix(this.object.matrixWorld);\n\n  const matrixWorld = this.object.matrixWorld;\n  const position = this.geometry.attributes.position;\n\n  //\n\n  const objGeometry = this.object.geometry;\n\n  if (objGeometry && objGeometry.isGeometry) {\n    const vertices = objGeometry.vertices;\n\n    const faces = objGeometry.faces;\n\n    idx = 0;\n\n    for (let i = 0, l = faces.length; i < l; i++) {\n      const face = faces[i];\n\n      for (let j = 0, jl = face.vertexNormals.length; j < jl; j++) {\n        const vertex = vertices[face[_keys[j]]];\n        const normal = face.vertexNormals[j];\n\n        _v1.copy(vertex).applyMatrix4(matrixWorld);\n        _v2.copy(normal).applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);\n\n        position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\n\n        idx = idx + 1;\n\n        position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\n\n        idx = idx + 1;\n      }\n    }\n  } else if (objGeometry && objGeometry.isBufferGeometry) {\n    const objPos = objGeometry.attributes.position;\n    const objNorm = objGeometry.attributes.normal;\n\n    idx = 0;\n\n    // for simplicity, ignore index and drawcalls, and render every normal\n\n    for (var j = 0, jl = objPos.count; j < jl; j++) {\n      _v1.set(objPos.getX(j), objPos.getY(j), objPos.getZ(j)).applyMatrix4(matrixWorld);\n      _v2.set(objNorm.getX(j), objNorm.getY(j), objNorm.getZ(j));\n      _v2.applyMatrix3(_normalMatrix).normalize().multiplyScalar(this.size).add(_v1);\n\n      position.setXYZ(idx, _v1.x, _v1.y, _v1.z);\n\n      idx = idx + 1;\n\n      position.setXYZ(idx, _v2.x, _v2.y, _v2.z);\n\n      idx = idx + 1;\n    }\n  }\n\n  position.needsUpdate = true;\n};\n\nexport { VertexNormalsHelper };\n","import * as THREE from 'three';\nimport { VertexNormalsHelper } from './vertexNormalsHelper';\n\n// Simple mesh helper that shows edges, wireframes, and face and vertex normals\nexport default class MeshHelper {\n  constructor(scene, mesh) {\n    this.mesh = mesh;\n    this.scene = scene;\n\n    const wireframe = new THREE.WireframeGeometry(this.mesh.geometry);\n    this.wireLine = new THREE.LineSegments(wireframe);\n    this.wireLine.material.depthTest = false;\n    this.wireLine.material.opacity = 0.25;\n    this.wireLine.material.transparent = true;\n\n    const edges = new THREE.EdgesGeometry(this.mesh.geometry);\n    this.edgesLine = new THREE.LineSegments(edges);\n    this.edgesLine.material.depthTest = false;\n    this.edgesLine.material.opacity = 0.25;\n    this.edgesLine.material.transparent = true;\n\n    this.vertexHelper = new VertexNormalsHelper(this.mesh, 2);\n    this.boxHelper = new THREE.BoxHelper(this.mesh);\n  }\n\n  enable() {\n    this.mesh.add(this.wireLine);\n    this.mesh.add(this.edgesLine);\n\n    this.scene.add(this.vertexHelper);\n    this.scene.add(this.boxHelper);\n  }\n\n  disable() {\n    this.mesh.remove(this.wireLine);\n    this.mesh.remove(this.edgesLine);\n\n    this.scene.remove(this.vertexHelper);\n    this.scene.remove(this.boxHelper);\n  }\n}\n","// Provides simple static functions that are used multiple times in the app\nexport default class Helpers {\n  static throttle(fn, threshhold, scope) {\n    threshhold || (threshhold = 250);\n    let last, deferTimer;\n\n    return function() {\n      const context = scope || this;\n\n      const now  = +new Date,\n        args = arguments;\n\n      if(last && now < last + threshhold) {\n        clearTimeout(deferTimer);\n        deferTimer = setTimeout(function() {\n          last = now;\n          fn.apply(context, args);\n        }, threshhold);\n      }\n      else {\n        last = now;\n        fn.apply(context, args);\n      }\n    };\n  }\n\n  static logProgress() {\n    return function(xhr) {\n      if(xhr.lengthComputable) {\n        const percentComplete = xhr.loaded / xhr.total * 100;\n\n        console.log(Math.round(percentComplete, 2) + '% downloaded');\n      }\n    }\n  }\n\n  static logError() {\n    return function(xhr) {\n      console.error(xhr);\n    }\n  }\n\n  static handleColorChange(color) {\n    return (value) => {\n      if(typeof value === 'string') {\n        value = value.replace('#', '0x');\n      }\n\n      color.setHex(value);\n    };\n  }\n\n  static update(mesh) {\n    this.needsUpdate(mesh.material, mesh.geometry);\n  }\n\n  static needsUpdate(material, geometry) {\n    return function() {\n      material.shading = +material.shading; //Ensure number\n      material.vertexColors = +material.vertexColors; //Ensure number\n      material.side = +material.side; //Ensure number\n      material.needsUpdate = true;\n      geometry.verticesNeedUpdate = true;\n      geometry.normalsNeedUpdate = true;\n      geometry.colorsNeedUpdate = true;\n    };\n  }\n\n  static updateTexture(material, materialKey, textures) {\n    return function(key) {\n      material[materialKey] = textures[key];\n      material.needsUpdate = true;\n    };\n  }\n}\n","import * as THREE from 'three';\n// Promise polyfill for IE\nimport { Promise } from 'es6-promise';\n\nimport Helpers from '../../utils/helpers';\nimport Config from '../../data/config';\n\n// This class preloads all textures in the imageFiles array in the Config via ES6 Promises.\n// Once all textures are done loading the model itself will be loaded after the Promise .then() callback.\n// Using promises to preload textures prevents issues when applying textures to materials\n// before the textures have loaded.\nexport default class Texture {\n  constructor() {\n    // Prop that will contain all loaded textures\n    this.textures = {};\n  }\n\n  load() {\n    const loader = new THREE.TextureLoader();\n    const maxAnisotropy = Config.maxAnisotropy;\n    const imageFiles = Config.texture.imageFiles;\n    const promiseArray = [];\n\n    loader.setPath(Config.texture.path);\n\n    imageFiles.forEach(imageFile => {\n      // Add an individual Promise for each image in array\n      promiseArray.push(new Promise((resolve, reject) => {\n        // Each Promise will attempt to load the image file\n        loader.load(imageFile.image,\n          // This gets called on load with the loaded texture\n          texture => {\n            texture.anisotropy = maxAnisotropy;\n\n            // Resolve Promise with object of texture if it is instance of THREE.Texture\n            const modelOBJ = {};\n            modelOBJ[imageFile.name] = texture;\n            if(modelOBJ[imageFile.name] instanceof THREE.Texture)\n              resolve(modelOBJ);\n          },\n          Helpers.logProgress(),\n          xhr => reject(new Error(xhr + 'An error occurred loading while loading ' + imageFile.image))\n        )\n      }));\n    });\n\n    // Iterate through all Promises in array and return another Promise when all have resolved or console log reason when any reject\n    return Promise.all(promiseArray).then(textures => {\n      // Set the textures prop object to have name be the resolved texture\n      for(let i = 0; i < textures.length; i++) {\n        this.textures[Object.keys(textures[i])[0]] = textures[i][Object.keys(textures[i])[0]];\n      }\n    }, reason => console.log(reason));\n  }\n}\n","/**\n * @author Rich Tibbett / https://github.com/richtr\n * @author mrdoob / http://mrdoob.com/\n * @author Tony Parisi / http://www.tonyparisi.com/\n * @author Takahiro / https://github.com/takahirox\n * @author Don McCurdy / https://www.donmccurdy.com\n */\n\nimport {\n  AnimationClip,\n  Bone,\n  Box3,\n  BufferAttribute,\n  BufferGeometry,\n  ClampToEdgeWrapping,\n  Color,\n  DirectionalLight,\n  DoubleSide,\n  FileLoader,\n  FrontSide,\n  Group,\n  InterleavedBuffer,\n  InterleavedBufferAttribute,\n  Interpolant,\n  InterpolateDiscrete,\n  InterpolateLinear,\n  Line,\n  LineBasicMaterial,\n  LineLoop,\n  LineSegments,\n  LinearFilter,\n  LinearMipmapLinearFilter,\n  LinearMipmapNearestFilter,\n  Loader,\n  LoaderUtils,\n  Material,\n  MathUtils,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  MeshPhysicalMaterial,\n  MeshStandardMaterial,\n  MirroredRepeatWrapping,\n  NearestFilter,\n  NearestMipmapLinearFilter,\n  NearestMipmapNearestFilter,\n  NumberKeyframeTrack,\n  Object3D,\n  OrthographicCamera,\n  PerspectiveCamera,\n  PointLight,\n  Points,\n  PointsMaterial,\n  PropertyBinding,\n  QuaternionKeyframeTrack,\n  RGBAFormat,\n  RGBFormat,\n  RepeatWrapping,\n  Skeleton,\n  SkinnedMesh,\n  Sphere,\n  SpotLight,\n  TangentSpaceNormalMap,\n  TextureLoader,\n  TriangleFanDrawMode,\n  TriangleStripDrawMode,\n  Vector2,\n  Vector3,\n  VectorKeyframeTrack,\n  sRGBEncoding\n} from 'three';\n\nconst GLTFLoader = (function () {\n  function GLTFLoader(manager) {\n    Loader.call(this, manager);\n\n    this.dracoLoader = null;\n    this.ddsLoader = null;\n  }\n\n  GLTFLoader.prototype = Object.assign(Object.create(Loader.prototype), {\n    constructor: GLTFLoader,\n\n    load: function (url, onLoad, onProgress, onError) {\n      var scope = this;\n\n      var resourcePath;\n\n      if (this.resourcePath !== '') {\n        resourcePath = this.resourcePath;\n      } else if (this.path !== '') {\n        resourcePath = this.path;\n      } else {\n        resourcePath = LoaderUtils.extractUrlBase(url);\n      }\n\n      // Tells the LoadingManager to track an extra item, which resolves after\n      // the model is fully loaded. This means the count of items loaded will\n      // be incorrect, but ensures manager.onLoad() does not fire early.\n      scope.manager.itemStart(url);\n\n      var _onError = function (e) {\n        if (onError) {\n          onError(e);\n        } else {\n          console.error(e);\n        }\n\n        scope.manager.itemError(url);\n        scope.manager.itemEnd(url);\n      };\n\n      var loader = new FileLoader(scope.manager);\n\n      loader.setPath(this.path);\n      loader.setResponseType('arraybuffer');\n\n      if (scope.crossOrigin === 'use-credentials') {\n        loader.setWithCredentials(true);\n      }\n\n      loader.load(\n        url,\n        function (data) {\n          try {\n            scope.parse(\n              data,\n              resourcePath,\n              function (gltf) {\n                onLoad(gltf);\n\n                scope.manager.itemEnd(url);\n              },\n              _onError\n            );\n          } catch (e) {\n            _onError(e);\n          }\n        },\n        onProgress,\n        _onError\n      );\n    },\n\n    setDRACOLoader: function (dracoLoader) {\n      this.dracoLoader = dracoLoader;\n      return this;\n    },\n\n    setDDSLoader: function (ddsLoader) {\n      this.ddsLoader = ddsLoader;\n      return this;\n    },\n\n    parse: function (data, path, onLoad, onError) {\n      var content;\n      var extensions = {};\n\n      if (typeof data === 'string') {\n        content = data;\n      } else {\n        var magic = LoaderUtils.decodeText(new Uint8Array(data, 0, 4));\n\n        if (magic === BINARY_EXTENSION_HEADER_MAGIC) {\n          try {\n            extensions[EXTENSIONS.KHR_BINARY_GLTF] = new GLTFBinaryExtension(data);\n          } catch (error) {\n            if (onError) onError(error);\n            return;\n          }\n\n          content = extensions[EXTENSIONS.KHR_BINARY_GLTF].content;\n        } else {\n          content = LoaderUtils.decodeText(new Uint8Array(data));\n        }\n      }\n\n      var json = JSON.parse(content);\n\n      if (json.asset === undefined || json.asset.version[0] < 2) {\n        if (onError)\n          onError(\n            new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.')\n          );\n        return;\n      }\n\n      if (json.extensionsUsed) {\n        for (var i = 0; i < json.extensionsUsed.length; ++i) {\n          var extensionName = json.extensionsUsed[i];\n          var extensionsRequired = json.extensionsRequired || [];\n\n          switch (extensionName) {\n            case EXTENSIONS.KHR_LIGHTS_PUNCTUAL:\n              extensions[extensionName] = new GLTFLightsExtension(json);\n              break;\n\n            case EXTENSIONS.KHR_MATERIALS_CLEARCOAT:\n              extensions[extensionName] = new GLTFMaterialsClearcoatExtension();\n              break;\n\n            case EXTENSIONS.KHR_MATERIALS_UNLIT:\n              extensions[extensionName] = new GLTFMaterialsUnlitExtension();\n              break;\n\n            case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n              extensions[extensionName] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n              break;\n\n            case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n              extensions[extensionName] = new GLTFDracoMeshCompressionExtension(\n                json,\n                this.dracoLoader\n              );\n              break;\n\n            case EXTENSIONS.MSFT_TEXTURE_DDS:\n              extensions[extensionName] = new GLTFTextureDDSExtension(this.ddsLoader);\n              break;\n\n            case EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n              extensions[extensionName] = new GLTFTextureTransformExtension();\n              break;\n\n            case EXTENSIONS.KHR_MESH_QUANTIZATION:\n              extensions[extensionName] = new GLTFMeshQuantizationExtension();\n              break;\n\n            default:\n              if (extensionsRequired.indexOf(extensionName) >= 0) {\n                console.warn('THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".');\n              }\n          }\n        }\n      }\n\n      var parser = new GLTFParser(json, extensions, {\n        path: path || this.resourcePath || '',\n        crossOrigin: this.crossOrigin,\n        manager: this.manager\n      });\n\n      parser.parse(onLoad, onError);\n    },\n  });\n\n  /* GLTFREGISTRY */\n\n  function GLTFRegistry() {\n    var objects = {};\n\n    return {\n      get: function (key) {\n        return objects[key];\n      },\n\n      add: function (key, object) {\n        objects[key] = object;\n      },\n\n      remove: function (key) {\n        delete objects[key];\n      },\n\n      removeAll: function () {\n        objects = {};\n      },\n    };\n  }\n\n  /*********************************/\n  /********** EXTENSIONS ***********/\n  /*********************************/\n\n  var EXTENSIONS = {\n    KHR_BINARY_GLTF: 'KHR_binary_glTF',\n    KHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n    KHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n    KHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n    KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n    KHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n    KHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n    KHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n    MSFT_TEXTURE_DDS: 'MSFT_texture_dds'\n  };\n\n  /**\n   * DDS Texture Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/MSFT_texture_dds\n   *\n   */\n  function GLTFTextureDDSExtension(ddsLoader) {\n    if (!ddsLoader) {\n      throw new Error(\n        'THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader'\n      );\n    }\n\n    this.name = EXTENSIONS.MSFT_TEXTURE_DDS;\n    this.ddsLoader = ddsLoader;\n  }\n\n  /**\n   * Punctual Lights Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n   */\n  function GLTFLightsExtension(json) {\n    this.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n    var extension = (json.extensions && json.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL]) || {};\n    this.lightDefs = extension.lights || [];\n  }\n\n  GLTFLightsExtension.prototype.loadLight = function (lightIndex) {\n    var lightDef = this.lightDefs[lightIndex];\n    var lightNode;\n\n    var color = new Color(0xffffff);\n    if (lightDef.color !== undefined) color.fromArray(lightDef.color);\n\n    var range = lightDef.range !== undefined ? lightDef.range : 0;\n\n    switch (lightDef.type) {\n      case 'directional':\n        lightNode = new DirectionalLight(color);\n        lightNode.target.position.set(0, 0, -1);\n        lightNode.add(lightNode.target);\n        break;\n\n      case 'point':\n        lightNode = new PointLight(color);\n        lightNode.distance = range;\n        break;\n\n      case 'spot':\n        lightNode = new SpotLight(color);\n        lightNode.distance = range;\n        // Handle spotlight properties.\n        lightDef.spot = lightDef.spot || {};\n        lightDef.spot.innerConeAngle =\n          lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n        lightDef.spot.outerConeAngle =\n          lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n        lightNode.angle = lightDef.spot.outerConeAngle;\n        lightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n        lightNode.target.position.set(0, 0, -1);\n        lightNode.add(lightNode.target);\n        break;\n\n      default:\n        throw new Error('THREE.GLTFLoader: Unexpected light type, \"' + lightDef.type + '\".');\n    }\n\n    // Some lights (e.g. spot) default to a position other than the origin. Reset the position\n    // here, because node-level parsing will only override position if explicitly specified.\n    lightNode.position.set(0, 0, 0);\n\n    lightNode.decay = 2;\n\n    if (lightDef.intensity !== undefined) lightNode.intensity = lightDef.intensity;\n\n    lightNode.name = lightDef.name || 'light_' + lightIndex;\n\n    return Promise.resolve(lightNode);\n  };\n\n  /**\n   * Unlit Materials Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n   */\n  function GLTFMaterialsUnlitExtension() {\n    this.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n  }\n\n  GLTFMaterialsUnlitExtension.prototype.getMaterialType = function () {\n    return MeshBasicMaterial;\n  };\n\n  GLTFMaterialsUnlitExtension.prototype.extendParams = function (\n    materialParams,\n    materialDef,\n    parser\n  ) {\n    var pending = [];\n\n    materialParams.color = new Color(1.0, 1.0, 1.0);\n    materialParams.opacity = 1.0;\n\n    var metallicRoughness = materialDef.pbrMetallicRoughness;\n\n    if (metallicRoughness) {\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        var array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture)\n        );\n      }\n    }\n\n    return Promise.all(pending);\n  };\n\n  /**\n   * Clearcoat Materials Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n   */\n  function GLTFMaterialsClearcoatExtension() {\n    this.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n  }\n\n  GLTFMaterialsClearcoatExtension.prototype.getMaterialType = function () {\n    return MeshPhysicalMaterial;\n  };\n\n  GLTFMaterialsClearcoatExtension.prototype.extendParams = function (\n    materialParams,\n    materialDef,\n    parser\n  ) {\n    var pending = [];\n\n    var extension = materialDef.extensions[this.name];\n\n    if (extension.clearcoatFactor !== undefined) {\n      materialParams.clearcoat = extension.clearcoatFactor;\n    }\n\n    if (extension.clearcoatTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(materialParams, 'clearcoatMap', extension.clearcoatTexture)\n      );\n    }\n\n    if (extension.clearcoatRoughnessFactor !== undefined) {\n      materialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n    }\n\n    if (extension.clearcoatRoughnessTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatRoughnessMap',\n          extension.clearcoatRoughnessTexture\n        )\n      );\n    }\n\n    if (extension.clearcoatNormalTexture !== undefined) {\n      pending.push(\n        parser.assignTexture(\n          materialParams,\n          'clearcoatNormalMap',\n          extension.clearcoatNormalTexture\n        )\n      );\n\n      if (extension.clearcoatNormalTexture.scale !== undefined) {\n        var scale = extension.clearcoatNormalTexture.scale;\n\n        materialParams.clearcoatNormalScale = new Vector2(scale, scale);\n      }\n    }\n\n    return Promise.all(pending);\n  };\n\n  /* BINARY EXTENSION */\n  var BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\n  var BINARY_EXTENSION_HEADER_LENGTH = 12;\n  var BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4e4f534a, BIN: 0x004e4942 };\n\n  function GLTFBinaryExtension(data) {\n    this.name = EXTENSIONS.KHR_BINARY_GLTF;\n    this.content = null;\n    this.body = null;\n\n    var headerView = new DataView(data, 0, BINARY_EXTENSION_HEADER_LENGTH);\n\n    this.header = {\n      magic: LoaderUtils.decodeText(new Uint8Array(data.slice(0, 4))),\n      version: headerView.getUint32(4, true),\n      length: headerView.getUint32(8, true)\n    };\n\n    if (this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC) {\n      throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');\n    } else if (this.header.version < 2.0) {\n      throw new Error('THREE.GLTFLoader: Legacy binary file detected.');\n    }\n\n    var chunkView = new DataView(data, BINARY_EXTENSION_HEADER_LENGTH);\n    var chunkIndex = 0;\n\n    while (chunkIndex < chunkView.byteLength) {\n      var chunkLength = chunkView.getUint32(chunkIndex, true);\n      chunkIndex += 4;\n\n      var chunkType = chunkView.getUint32(chunkIndex, true);\n      chunkIndex += 4;\n\n      if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON) {\n        var contentArray = new Uint8Array(\n          data,\n          BINARY_EXTENSION_HEADER_LENGTH + chunkIndex,\n          chunkLength\n        );\n        this.content = LoaderUtils.decodeText(contentArray);\n      } else if (chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN) {\n        var byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n        this.body = data.slice(byteOffset, byteOffset + chunkLength);\n      }\n\n      // Clients must ignore chunks with unknown types.\n\n      chunkIndex += chunkLength;\n    }\n\n    if (this.content === null) {\n      throw new Error('THREE.GLTFLoader: JSON content not found.');\n    }\n  }\n\n  /**\n   * DRACO Mesh Compression Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n   */\n  function GLTFDracoMeshCompressionExtension(json, dracoLoader) {\n    if (!dracoLoader) {\n      throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');\n    }\n\n    this.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n    this.json = json;\n    this.dracoLoader = dracoLoader;\n    this.dracoLoader.preload();\n  }\n\n  GLTFDracoMeshCompressionExtension.prototype.decodePrimitive = function (primitive, parser) {\n    var json = this.json;\n    var dracoLoader = this.dracoLoader;\n    var bufferViewIndex = primitive.extensions[this.name].bufferView;\n    var gltfAttributeMap = primitive.extensions[this.name].attributes;\n    var threeAttributeMap = {};\n    var attributeNormalizedMap = {};\n    var attributeTypeMap = {};\n\n    for (var attributeName in gltfAttributeMap) {\n      var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n      threeAttributeMap[threeAttributeName] = gltfAttributeMap[attributeName];\n    }\n\n    for (attributeName in primitive.attributes) {\n      var threeAttributeName = ATTRIBUTES[attributeName] || attributeName.toLowerCase();\n\n      if (gltfAttributeMap[attributeName] !== undefined) {\n        var accessorDef = json.accessors[primitive.attributes[attributeName]];\n        var componentType = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n        attributeTypeMap[threeAttributeName] = componentType;\n        attributeNormalizedMap[threeAttributeName] = accessorDef.normalized === true;\n      }\n    }\n\n    return parser.getDependency('bufferView', bufferViewIndex).then(function (bufferView) {\n      return new Promise(function (resolve) {\n        dracoLoader.decodeDracoFile(\n          bufferView,\n          function (geometry) {\n            for (var attributeName in geometry.attributes) {\n              var attribute = geometry.attributes[attributeName];\n              var normalized = attributeNormalizedMap[attributeName];\n\n              if (normalized !== undefined) attribute.normalized = normalized;\n            }\n\n            resolve(geometry);\n          },\n          threeAttributeMap,\n          attributeTypeMap\n        );\n      });\n    });\n  };\n\n  /**\n   * Texture Transform Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n   */\n  function GLTFTextureTransformExtension() {\n    this.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n  }\n\n  GLTFTextureTransformExtension.prototype.extendTexture = function (texture, transform) {\n    texture = texture.clone();\n\n    if (transform.offset !== undefined) {\n      texture.offset.fromArray(transform.offset);\n    }\n\n    if (transform.rotation !== undefined) {\n      texture.rotation = transform.rotation;\n    }\n\n    if (transform.scale !== undefined) {\n      texture.repeat.fromArray(transform.scale);\n    }\n\n    if (transform.texCoord !== undefined) {\n      console.warn(\n        'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.'\n      );\n    }\n\n    texture.needsUpdate = true;\n\n    return texture;\n  };\n\n  /**\n   * Specular-Glossiness Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_pbrSpecularGlossiness\n   */\n\n  /**\n   * A sub class of StandardMaterial with some of the functionality\n   * changed via the `onBeforeCompile` callback\n   * @pailhead\n   */\n\n  function GLTFMeshStandardSGMaterial(params) {\n    MeshStandardMaterial.call(this);\n\n    this.isGLTFSpecularGlossinessMaterial = true;\n\n    //various chunks that need replacing\n    var specularMapParsFragmentChunk = [\n      '#ifdef USE_SPECULARMAP',\n      '\tuniform sampler2D specularMap;',\n      '#endif',\n    ].join('\\n');\n\n    var glossinessMapParsFragmentChunk = [\n      '#ifdef USE_GLOSSINESSMAP',\n      '\tuniform sampler2D glossinessMap;',\n      '#endif',\n    ].join('\\n');\n\n    var specularMapFragmentChunk = [\n      'vec3 specularFactor = specular;',\n      '#ifdef USE_SPECULARMAP',\n      '\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n      '\ttexelSpecular = sRGBToLinear( texelSpecular );',\n      '\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n      '\tspecularFactor *= texelSpecular.rgb;',\n      '#endif',\n    ].join('\\n');\n\n    var glossinessMapFragmentChunk = [\n      'float glossinessFactor = glossiness;',\n      '#ifdef USE_GLOSSINESSMAP',\n      '\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n      '\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n      '\tglossinessFactor *= texelGlossiness.a;',\n      '#endif',\n    ].join('\\n');\n\n    var lightPhysicalFragmentChunk = [\n      'PhysicalMaterial material;',\n      'material.diffuseColor = diffuseColor.rgb;',\n      'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n      'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n      'material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.',\n      'material.specularRoughness += geometryRoughness;',\n      'material.specularRoughness = min( material.specularRoughness, 1.0 );',\n      'material.specularColor = specularFactor.rgb;',\n    ].join('\\n');\n\n    var uniforms = {\n      specular: { value: new Color().setHex(0xffffff) },\n      glossiness: { value: 1 },\n      specularMap: { value: null },\n      glossinessMap: { value: null },\n    };\n\n    this._extraUniforms = uniforms;\n\n    // please see #14031 or #13198 for an alternate approach\n    this.onBeforeCompile = function (shader) {\n      for (var uniformName in uniforms) {\n        shader.uniforms[uniformName] = uniforms[uniformName];\n      }\n\n      shader.fragmentShader = shader.fragmentShader.replace(\n        'uniform float roughness;',\n        'uniform vec3 specular;'\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        'uniform float metalness;',\n        'uniform float glossiness;'\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <roughnessmap_pars_fragment>',\n        specularMapParsFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <metalnessmap_pars_fragment>',\n        glossinessMapParsFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <roughnessmap_fragment>',\n        specularMapFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <metalnessmap_fragment>',\n        glossinessMapFragmentChunk\n      );\n      shader.fragmentShader = shader.fragmentShader.replace(\n        '#include <lights_physical_fragment>',\n        lightPhysicalFragmentChunk\n      );\n    };\n\n    /*eslint-disable*/\n    Object.defineProperties(this, {\n      specular: {\n        get: function () {\n          return uniforms.specular.value;\n        },\n        set: function (v) {\n          uniforms.specular.value = v;\n        },\n      },\n      specularMap: {\n        get: function () {\n          return uniforms.specularMap.value;\n        },\n        set: function (v) {\n          uniforms.specularMap.value = v;\n        },\n      },\n      glossiness: {\n        get: function () {\n          return uniforms.glossiness.value;\n        },\n        set: function (v) {\n          uniforms.glossiness.value = v;\n        },\n      },\n      glossinessMap: {\n        get: function () {\n          return uniforms.glossinessMap.value;\n        },\n        set: function (v) {\n          uniforms.glossinessMap.value = v;\n          //how about something like this - @pailhead\n          if (v) {\n            this.defines.USE_GLOSSINESSMAP = '';\n            // set USE_ROUGHNESSMAP to enable vUv\n            this.defines.USE_ROUGHNESSMAP = '';\n          } else {\n            delete this.defines.USE_ROUGHNESSMAP;\n            delete this.defines.USE_GLOSSINESSMAP;\n          }\n        },\n      },\n    });\n\n    /*eslint-enable*/\n    delete this.metalness;\n    delete this.roughness;\n    delete this.metalnessMap;\n    delete this.roughnessMap;\n\n    this.setValues(params);\n  }\n\n  GLTFMeshStandardSGMaterial.prototype = Object.create(MeshStandardMaterial.prototype);\n  GLTFMeshStandardSGMaterial.prototype.constructor = GLTFMeshStandardSGMaterial;\n\n  GLTFMeshStandardSGMaterial.prototype.copy = function (source) {\n    MeshStandardMaterial.prototype.copy.call(this, source);\n    this.specularMap = source.specularMap;\n    this.specular.copy(source.specular);\n    this.glossinessMap = source.glossinessMap;\n    this.glossiness = source.glossiness;\n    delete this.metalness;\n    delete this.roughness;\n    delete this.metalnessMap;\n    delete this.roughnessMap;\n    return this;\n  };\n\n  function GLTFMaterialsPbrSpecularGlossinessExtension() {\n    return {\n      name: EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,\n\n      specularGlossinessParams: [\n        'color',\n        'map',\n        'lightMap',\n        'lightMapIntensity',\n        'aoMap',\n        'aoMapIntensity',\n        'emissive',\n        'emissiveIntensity',\n        'emissiveMap',\n        'bumpMap',\n        'bumpScale',\n        'normalMap',\n        'normalMapType',\n        'displacementMap',\n        'displacementScale',\n        'displacementBias',\n        'specularMap',\n        'specular',\n        'glossinessMap',\n        'glossiness',\n        'alphaMap',\n        'envMap',\n        'envMapIntensity',\n        'refractionRatio',\n      ],\n\n      getMaterialType: function () {\n        return GLTFMeshStandardSGMaterial;\n      },\n\n      extendParams: function (materialParams, materialDef, parser) {\n        var pbrSpecularGlossiness = materialDef.extensions[this.name];\n\n        materialParams.color = new Color(1.0, 1.0, 1.0);\n        materialParams.opacity = 1.0;\n\n        var pending = [];\n\n        if (Array.isArray(pbrSpecularGlossiness.diffuseFactor)) {\n          var array = pbrSpecularGlossiness.diffuseFactor;\n\n          materialParams.color.fromArray(array);\n          materialParams.opacity = array[3];\n        }\n\n        if (pbrSpecularGlossiness.diffuseTexture !== undefined) {\n          pending.push(\n            parser.assignTexture(materialParams, 'map', pbrSpecularGlossiness.diffuseTexture)\n          );\n        }\n\n        materialParams.emissive = new Color(0.0, 0.0, 0.0);\n        materialParams.glossiness =\n          pbrSpecularGlossiness.glossinessFactor !== undefined\n            ? pbrSpecularGlossiness.glossinessFactor\n            : 1.0;\n        materialParams.specular = new Color(1.0, 1.0, 1.0);\n\n        if (Array.isArray(pbrSpecularGlossiness.specularFactor)) {\n          materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);\n        }\n\n        if (pbrSpecularGlossiness.specularGlossinessTexture !== undefined) {\n          var specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n          pending.push(parser.assignTexture(materialParams, 'glossinessMap', specGlossMapDef));\n          pending.push(parser.assignTexture(materialParams, 'specularMap', specGlossMapDef));\n        }\n\n        return Promise.all(pending);\n      },\n\n      createMaterial: function (materialParams) {\n        var material = new GLTFMeshStandardSGMaterial(materialParams);\n        material.fog = true;\n\n        material.color = materialParams.color;\n\n        material.map = materialParams.map === undefined ? null : materialParams.map;\n\n        material.lightMap = null;\n        material.lightMapIntensity = 1.0;\n\n        material.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n        material.aoMapIntensity = 1.0;\n\n        material.emissive = materialParams.emissive;\n        material.emissiveIntensity = 1.0;\n        material.emissiveMap =\n          materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n        material.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n        material.bumpScale = 1;\n\n        material.normalMap =\n          materialParams.normalMap === undefined ? null : materialParams.normalMap;\n        material.normalMapType = TangentSpaceNormalMap;\n\n        if (materialParams.normalScale) material.normalScale = materialParams.normalScale;\n\n        material.displacementMap = null;\n        material.displacementScale = 1;\n        material.displacementBias = 0;\n\n        material.specularMap =\n          materialParams.specularMap === undefined ? null : materialParams.specularMap;\n        material.specular = materialParams.specular;\n\n        material.glossinessMap =\n          materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n        material.glossiness = materialParams.glossiness;\n\n        material.alphaMap = null;\n\n        material.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n        material.envMapIntensity = 1.0;\n\n        material.refractionRatio = 0.98;\n\n        return material;\n      },\n    };\n  }\n\n  /**\n   * Mesh Quantization Extension\n   *\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n   */\n  function GLTFMeshQuantizationExtension() {\n    this.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n  }\n\n  /*********************************/\n  /********** INTERPOLATION ********/\n  /*********************************/\n\n  // Spline Interpolation\n  // Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\n  function GLTFCubicSplineInterpolant(parameterPositions, sampleValues, sampleSize, resultBuffer) {\n    Interpolant.call(this, parameterPositions, sampleValues, sampleSize, resultBuffer);\n  }\n\n  GLTFCubicSplineInterpolant.prototype = Object.create(Interpolant.prototype);\n  GLTFCubicSplineInterpolant.prototype.constructor = GLTFCubicSplineInterpolant;\n\n  GLTFCubicSplineInterpolant.prototype.copySampleValue_ = function (index) {\n    // Copies a sample value to the result buffer. See description of glTF\n    // CUBICSPLINE values layout in interpolate_() function below.\n\n    var result = this.resultBuffer,\n        values = this.sampleValues,\n        valueSize = this.valueSize,\n        offset = index * valueSize * 3 + valueSize;\n\n    for (var i = 0; i !== valueSize; i++) {\n      result[i] = values[offset + i];\n    }\n\n    return result;\n  };\n\n  GLTFCubicSplineInterpolant.prototype.beforeStart_ =\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n  GLTFCubicSplineInterpolant.prototype.afterEnd_ =\n    GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\n  GLTFCubicSplineInterpolant.prototype.interpolate_ = function (i1, t0, t, t1) {\n    var result = this.resultBuffer;\n    var values = this.sampleValues;\n    var stride = this.valueSize;\n\n    var stride2 = stride * 2;\n    var stride3 = stride * 3;\n\n    var td = t1 - t0;\n\n    var p = (t - t0) / td;\n    var pp = p * p;\n    var ppp = pp * p;\n\n    var offset1 = i1 * stride3;\n    var offset0 = offset1 - stride3;\n\n    var s2 = -2 * ppp + 3 * pp;\n    var s3 = ppp - pp;\n    var s0 = 1 - s2;\n    var s1 = s3 - pp + p;\n\n    // Layout of keyframe output values for CUBICSPLINE animations:\n    //   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n    for (var i = 0; i !== stride; i++) {\n      var p0 = values[offset0 + i + stride]; // splineVertex_k\n      var m0 = values[offset0 + i + stride2] * td; // outTangent_k * (t_k+1 - t_k)\n      var p1 = values[offset1 + i + stride]; // splineVertex_k+1\n      var m1 = values[offset1 + i] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n      result[i] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n    }\n\n    return result;\n  };\n\n  /*********************************/\n  /********** INTERNALS ************/\n  /*********************************/\n\n  /* CONSTANTS */\n\n  var WEBGL_CONSTANTS = {\n    FLOAT: 5126,\n    //FLOAT_MAT2: 35674,\n    FLOAT_MAT3: 35675,\n    FLOAT_MAT4: 35676,\n    FLOAT_VEC2: 35664,\n    FLOAT_VEC3: 35665,\n    FLOAT_VEC4: 35666,\n    LINEAR: 9729,\n    REPEAT: 10497,\n    SAMPLER_2D: 35678,\n    POINTS: 0,\n    LINES: 1,\n    LINE_LOOP: 2,\n    LINE_STRIP: 3,\n    TRIANGLES: 4,\n    TRIANGLE_STRIP: 5,\n    TRIANGLE_FAN: 6,\n    UNSIGNED_BYTE: 5121,\n    UNSIGNED_SHORT: 5123,\n  };\n\n  var WEBGL_COMPONENT_TYPES = {\n    5120: Int8Array,\n    5121: Uint8Array,\n    5122: Int16Array,\n    5123: Uint16Array,\n    5125: Uint32Array,\n    5126: Float32Array,\n  };\n\n  var WEBGL_FILTERS = {\n    9728: NearestFilter,\n    9729: LinearFilter,\n    9984: NearestMipmapNearestFilter,\n    9985: LinearMipmapNearestFilter,\n    9986: NearestMipmapLinearFilter,\n    9987: LinearMipmapLinearFilter,\n  };\n\n  var WEBGL_WRAPPINGS = {\n    33071: ClampToEdgeWrapping,\n    33648: MirroredRepeatWrapping,\n    10497: RepeatWrapping,\n  };\n\n  var WEBGL_TYPE_SIZES = {\n    SCALAR: 1,\n    VEC2: 2,\n    VEC3: 3,\n    VEC4: 4,\n    MAT2: 4,\n    MAT3: 9,\n    MAT4: 16,\n  };\n\n  var ATTRIBUTES = {\n    POSITION: 'position',\n    NORMAL: 'normal',\n    TANGENT: 'tangent',\n    TEXCOORD_0: 'uv',\n    TEXCOORD_1: 'uv2',\n    COLOR_0: 'color',\n    WEIGHTS_0: 'skinWeight',\n    JOINTS_0: 'skinIndex',\n  };\n\n  var PATH_PROPERTIES = {\n    scale: 'scale',\n    translation: 'position',\n    rotation: 'quaternion',\n    weights: 'morphTargetInfluences',\n  };\n\n  var INTERPOLATION = {\n    CUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n    // keyframe track will be initialized with a default interpolation type, then modified.\n    LINEAR: InterpolateLinear,\n    STEP: InterpolateDiscrete,\n  };\n\n  var ALPHA_MODES = {\n    OPAQUE: 'OPAQUE',\n    MASK: 'MASK',\n    BLEND: 'BLEND',\n  };\n\n  var MIME_TYPE_FORMATS = {\n    'image/png': RGBAFormat,\n    'image/jpeg': RGBFormat,\n  };\n\n  /* UTILITY FUNCTIONS */\n\n  function resolveURL(url, path) {\n    // Invalid URL\n    if (typeof url !== 'string' || url === '') return '';\n\n    // Host Relative URL\n    if (/^https?:\\/\\//i.test(path) && /^\\//.test(url)) {\n      // eslint-disable-next-line no-useless-escape\n      path = path.replace(/(^https?:\\/\\/[^\\/]+).*/i, '$1');\n    }\n\n    // Absolute URL http://,https://,//\n    if (/^(https?:)?\\/\\//i.test(url)) return url;\n\n    // Data URI\n    if (/^data:.*,.*$/i.test(url)) return url;\n\n    // Blob URL\n    if (/^blob:.*$/i.test(url)) return url;\n\n    // Relative URL\n    return path + url;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n   */\n  function createDefaultMaterial(cache) {\n    if (cache['DefaultMaterial'] === undefined) {\n      cache['DefaultMaterial'] = new MeshStandardMaterial({\n        color: 0xffffff,\n        emissive: 0x000000,\n        metalness: 1,\n        roughness: 1,\n        transparent: false,\n        depthTest: true,\n        side: FrontSide,\n      });\n    }\n\n    return cache['DefaultMaterial'];\n  }\n\n  function addUnknownExtensionsToUserData(knownExtensions, object, objectDef) {\n    // Add unknown glTF extensions to an object's userData.\n\n    for (var name in objectDef.extensions) {\n      if (knownExtensions[name] === undefined) {\n        object.userData.gltfExtensions = object.userData.gltfExtensions || {};\n        object.userData.gltfExtensions[name] = objectDef.extensions[name];\n      }\n    }\n  }\n\n  /**\n   * @param {Object3D|Material|BufferGeometry} object\n   * @param {GLTF.definition} gltfDef\n   */\n  function assignExtrasToUserData(object, gltfDef) {\n    if (gltfDef.extras !== undefined) {\n      if (typeof gltfDef.extras === 'object') {\n        Object.assign(object.userData, gltfDef.extras);\n      } else {\n        console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras);\n      }\n    }\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n   *\n   * @param {BufferGeometry} geometry\n   * @param {Array<GLTF.Target>} targets\n   * @param {GLTFParser} parser\n   * @return {Promise<BufferGeometry>}\n   */\n  function addMorphTargets(geometry, targets, parser) {\n    var hasMorphPosition = false;\n    var hasMorphNormal = false;\n\n    for (var i = 0, il = targets.length; i < il; i++) {\n      var target = targets[i];\n\n      if (target.POSITION !== undefined) hasMorphPosition = true;\n      if (target.NORMAL !== undefined) hasMorphNormal = true;\n\n      if (hasMorphPosition && hasMorphNormal) break;\n    }\n\n    if (!hasMorphPosition && !hasMorphNormal) return Promise.resolve(geometry);\n\n    var pendingPositionAccessors = [];\n    var pendingNormalAccessors = [];\n\n    for (var i = 0, il = targets.length; i < il; i++) {\n      var target = targets[i];\n\n      if (hasMorphPosition) {\n        var pendingAccessor =\n              target.POSITION !== undefined\n                ? parser.getDependency('accessor', target.POSITION)\n                : geometry.attributes.position;\n\n        pendingPositionAccessors.push(pendingAccessor);\n      }\n\n      if (hasMorphNormal) {\n        var pendingAccessor =\n              target.NORMAL !== undefined\n                ? parser.getDependency('accessor', target.NORMAL)\n                : geometry.attributes.normal;\n\n        pendingNormalAccessors.push(pendingAccessor);\n      }\n    }\n\n    return Promise.all([\n      Promise.all(pendingPositionAccessors),\n      Promise.all(pendingNormalAccessors),\n    ]).then(function (accessors) {\n      var morphPositions = accessors[0];\n      var morphNormals = accessors[1];\n\n      if (hasMorphPosition) geometry.morphAttributes.position = morphPositions;\n      if (hasMorphNormal) geometry.morphAttributes.normal = morphNormals;\n      geometry.morphTargetsRelative = true;\n\n      return geometry;\n    });\n  }\n\n  /**\n   * @param {Mesh} mesh\n   * @param {GLTF.Mesh} meshDef\n   */\n  function updateMorphTargets(mesh, meshDef) {\n    mesh.updateMorphTargets();\n\n    if (meshDef.weights !== undefined) {\n      for (var i = 0, il = meshDef.weights.length; i < il; i++) {\n        mesh.morphTargetInfluences[i] = meshDef.weights[i];\n      }\n    }\n\n    // .extras has user-defined data, so check that .extras.targetNames is an array.\n    if (meshDef.extras && Array.isArray(meshDef.extras.targetNames)) {\n      var targetNames = meshDef.extras.targetNames;\n\n      if (mesh.morphTargetInfluences.length === targetNames.length) {\n        mesh.morphTargetDictionary = {};\n\n        for (var i = 0, il = targetNames.length; i < il; i++) {\n          mesh.morphTargetDictionary[targetNames[i]] = i;\n        }\n      } else {\n        console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');\n      }\n    }\n  }\n\n  function createPrimitiveKey(primitiveDef) {\n    var dracoExtension =\n          primitiveDef.extensions && primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];\n    var geometryKey;\n\n    if (dracoExtension) {\n      geometryKey =\n        'draco:' +\n        dracoExtension.bufferView +\n        ':' +\n        dracoExtension.indices +\n        ':' +\n        createAttributesKey(dracoExtension.attributes);\n    } else {\n      geometryKey =\n        primitiveDef.indices +\n        ':' +\n        createAttributesKey(primitiveDef.attributes) +\n        ':' +\n        primitiveDef.mode;\n    }\n\n    return geometryKey;\n  }\n\n  function createAttributesKey(attributes) {\n    var attributesKey = '';\n\n    var keys = Object.keys(attributes).sort();\n\n    for (var i = 0, il = keys.length; i < il; i++) {\n      attributesKey += keys[i] + ':' + attributes[keys[i]] + ';';\n    }\n\n    return attributesKey;\n  }\n\n  /* GLTF PARSER */\n\n  function GLTFParser(json, extensions, options) {\n    this.json = json || {};\n    this.extensions = extensions || {};\n    this.options = options || {};\n\n    // loader object cache\n    this.cache = new GLTFRegistry();\n\n    // BufferGeometry caching\n    this.primitiveCache = {};\n\n    this.textureLoader = new TextureLoader(this.options.manager);\n    this.textureLoader.setCrossOrigin(this.options.crossOrigin);\n\n    this.fileLoader = new FileLoader(this.options.manager);\n    this.fileLoader.setResponseType('arraybuffer');\n\n    if (this.options.crossOrigin === 'use-credentials') {\n      this.fileLoader.setWithCredentials(true);\n    }\n  }\n\n  GLTFParser.prototype.parse = function (onLoad, onError) {\n    var parser = this;\n    var json = this.json;\n    var extensions = this.extensions;\n\n    // Clear the loader cache\n    this.cache.removeAll();\n\n    // Mark the special nodes/meshes in json for efficient parse\n    this.markDefs();\n\n    Promise.all([\n      this.getDependencies('scene'),\n      this.getDependencies('animation'),\n      this.getDependencies('camera'),\n    ])\n      .then(function (dependencies) {\n        var result = {\n          scene: dependencies[0][json.scene || 0],\n          scenes: dependencies[0],\n          animations: dependencies[1],\n          cameras: dependencies[2],\n          asset: json.asset,\n          parser: parser,\n          userData: {},\n        };\n\n        addUnknownExtensionsToUserData(extensions, result, json);\n\n        assignExtrasToUserData(result, json);\n\n        onLoad(result);\n      })\n      .catch(onError);\n  };\n\n  /**\n   * Marks the special nodes/meshes in json for efficient parse.\n   */\n  GLTFParser.prototype.markDefs = function () {\n    var nodeDefs = this.json.nodes || [];\n    var skinDefs = this.json.skins || [];\n    var meshDefs = this.json.meshes || [];\n\n    var meshReferences = {};\n    var meshUses = {};\n\n    // Nothing in the node definition indicates whether it is a Bone or an\n    // Object3D. Use the skins' joint references to mark bones.\n    for (var skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex++) {\n      var joints = skinDefs[skinIndex].joints;\n\n      for (var i = 0, il = joints.length; i < il; i++) {\n        nodeDefs[joints[i]].isBone = true;\n      }\n    }\n\n    // Meshes can (and should) be reused by multiple nodes in a glTF asset. To\n    // avoid having more than one Mesh with the same name, count\n    // references and rename instances below.\n    //\n    // Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n    for (var nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex++) {\n      var nodeDef = nodeDefs[nodeIndex];\n\n      if (nodeDef.mesh !== undefined) {\n        if (meshReferences[nodeDef.mesh] === undefined) {\n          meshReferences[nodeDef.mesh] = meshUses[nodeDef.mesh] = 0;\n        }\n\n        meshReferences[nodeDef.mesh]++;\n\n        // Nothing in the mesh definition indicates whether it is\n        // a SkinnedMesh or Mesh. Use the node's mesh reference\n        // to mark SkinnedMesh if node has skin.\n        if (nodeDef.skin !== undefined) {\n          meshDefs[nodeDef.mesh].isSkinnedMesh = true;\n        }\n      }\n    }\n\n    this.json.meshReferences = meshReferences;\n    this.json.meshUses = meshUses;\n  };\n\n  /**\n   * Requests the specified dependency asynchronously, with caching.\n   * @param {string} type\n   * @param {number} index\n   * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n   */\n  GLTFParser.prototype.getDependency = function (type, index) {\n    var cacheKey = type + ':' + index;\n    var dependency = this.cache.get(cacheKey);\n\n    if (!dependency) {\n      switch (type) {\n        case 'scene':\n          dependency = this.loadScene(index);\n          break;\n\n        case 'node':\n          dependency = this.loadNode(index);\n          break;\n\n        case 'mesh':\n          dependency = this.loadMesh(index);\n          break;\n\n        case 'accessor':\n          dependency = this.loadAccessor(index);\n          break;\n\n        case 'bufferView':\n          dependency = this.loadBufferView(index);\n          break;\n\n        case 'buffer':\n          dependency = this.loadBuffer(index);\n          break;\n\n        case 'material':\n          dependency = this.loadMaterial(index);\n          break;\n\n        case 'texture':\n          dependency = this.loadTexture(index);\n          break;\n\n        case 'skin':\n          dependency = this.loadSkin(index);\n          break;\n\n        case 'animation':\n          dependency = this.loadAnimation(index);\n          break;\n\n        case 'camera':\n          dependency = this.loadCamera(index);\n          break;\n\n        case 'light':\n          dependency = this.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].loadLight(index);\n          break;\n\n        default:\n          throw new Error('Unknown type: ' + type);\n      }\n\n      this.cache.add(cacheKey, dependency);\n    }\n\n    return dependency;\n  };\n\n  /**\n   * Requests all dependencies of the specified type asynchronously, with caching.\n   * @param {string} type\n   * @return {Promise<Array<Object>>}\n   */\n  GLTFParser.prototype.getDependencies = function (type) {\n    var dependencies = this.cache.get(type);\n\n    if (!dependencies) {\n      var parser = this;\n      var defs = this.json[type + (type === 'mesh' ? 'es' : 's')] || [];\n\n      dependencies = Promise.all(\n        defs.map(function (def, index) {\n          return parser.getDependency(type, index);\n        })\n      );\n\n      this.cache.add(type, dependencies);\n    }\n\n    return dependencies;\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  GLTFParser.prototype.loadBuffer = function (bufferIndex) {\n    var bufferDef = this.json.buffers[bufferIndex];\n    var loader = this.fileLoader;\n\n    if (bufferDef.type && bufferDef.type !== 'arraybuffer') {\n      throw new Error('THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.');\n    }\n\n    // If present, GLB container is required to be the first buffer.\n    if (bufferDef.uri === undefined && bufferIndex === 0) {\n      return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);\n    }\n\n    var options = this.options;\n\n    return new Promise(function (resolve, reject) {\n      loader.load(resolveURL(bufferDef.uri, options.path), resolve, undefined, function () {\n        reject(new Error('THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".'));\n      });\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n   * @param {number} bufferViewIndex\n   * @return {Promise<ArrayBuffer>}\n   */\n  GLTFParser.prototype.loadBufferView = function (bufferViewIndex) {\n    var bufferViewDef = this.json.bufferViews[bufferViewIndex];\n\n    return this.getDependency('buffer', bufferViewDef.buffer).then(function (buffer) {\n      var byteLength = bufferViewDef.byteLength || 0;\n      var byteOffset = bufferViewDef.byteOffset || 0;\n      return buffer.slice(byteOffset, byteOffset + byteLength);\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n   * @param {number} accessorIndex\n   * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n   */\n  GLTFParser.prototype.loadAccessor = function (accessorIndex) {\n    var parser = this;\n    var json = this.json;\n\n    var accessorDef = this.json.accessors[accessorIndex];\n\n    if (accessorDef.bufferView === undefined && accessorDef.sparse === undefined) {\n      // Ignore empty accessors, which may be used to declare runtime\n      // information about attributes coming from another source (e.g. Draco\n      // compression extension).\n      return Promise.resolve(null);\n    }\n\n    var pendingBufferViews = [];\n\n    if (accessorDef.bufferView !== undefined) {\n      pendingBufferViews.push(this.getDependency('bufferView', accessorDef.bufferView));\n    } else {\n      pendingBufferViews.push(null);\n    }\n\n    if (accessorDef.sparse !== undefined) {\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.indices.bufferView)\n      );\n      pendingBufferViews.push(\n        this.getDependency('bufferView', accessorDef.sparse.values.bufferView)\n      );\n    }\n\n    return Promise.all(pendingBufferViews).then(function (bufferViews) {\n      var bufferView = bufferViews[0];\n\n      var itemSize = WEBGL_TYPE_SIZES[accessorDef.type];\n      var TypedArray = WEBGL_COMPONENT_TYPES[accessorDef.componentType];\n\n      // For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n      var elementBytes = TypedArray.BYTES_PER_ELEMENT;\n      var itemBytes = elementBytes * itemSize;\n      var byteOffset = accessorDef.byteOffset || 0;\n      var byteStride =\n            accessorDef.bufferView !== undefined\n              ? json.bufferViews[accessorDef.bufferView].byteStride\n              : undefined;\n      var normalized = accessorDef.normalized === true;\n      var array, bufferAttribute;\n\n      // The buffer is not interleaved if the stride is the item size in bytes.\n      if (byteStride && byteStride !== itemBytes) {\n        // Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n        // This makes sure that IBA.count reflects accessor.count properly\n        var ibSlice = Math.floor(byteOffset / byteStride);\n        var ibCacheKey =\n              'InterleavedBuffer:' +\n              accessorDef.bufferView +\n              ':' +\n              accessorDef.componentType +\n              ':' +\n              ibSlice +\n              ':' +\n              accessorDef.count;\n        var ib = parser.cache.get(ibCacheKey);\n\n        if (!ib) {\n          array = new TypedArray(\n            bufferView,\n            ibSlice * byteStride,\n            (accessorDef.count * byteStride) / elementBytes\n          );\n\n          // Integer parameters to IB/IBA are in array elements, not bytes.\n          ib = new InterleavedBuffer(array, byteStride / elementBytes);\n\n          parser.cache.add(ibCacheKey, ib);\n        }\n\n        bufferAttribute = new InterleavedBufferAttribute(\n          ib,\n          itemSize,\n          (byteOffset % byteStride) / elementBytes,\n          normalized\n        );\n      } else {\n        if (bufferView === null) {\n          array = new TypedArray(accessorDef.count * itemSize);\n        } else {\n          array = new TypedArray(bufferView, byteOffset, accessorDef.count * itemSize);\n        }\n\n        bufferAttribute = new BufferAttribute(array, itemSize, normalized);\n      }\n\n      // https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n      if (accessorDef.sparse !== undefined) {\n        var itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n        var TypedArrayIndices = WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];\n\n        var byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n        var byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n        var sparseIndices = new TypedArrayIndices(\n          bufferViews[1],\n          byteOffsetIndices,\n          accessorDef.sparse.count * itemSizeIndices\n        );\n        var sparseValues = new TypedArray(\n          bufferViews[2],\n          byteOffsetValues,\n          accessorDef.sparse.count * itemSize\n        );\n\n        if (bufferView !== null) {\n          // Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n          bufferAttribute = new BufferAttribute(\n            bufferAttribute.array.slice(),\n            bufferAttribute.itemSize,\n            bufferAttribute.normalized\n          );\n        }\n\n        for (var i = 0, il = sparseIndices.length; i < il; i++) {\n          var index = sparseIndices[i];\n\n          bufferAttribute.setX(index, sparseValues[i * itemSize]);\n          if (itemSize >= 2) bufferAttribute.setY(index, sparseValues[i * itemSize + 1]);\n          if (itemSize >= 3) bufferAttribute.setZ(index, sparseValues[i * itemSize + 2]);\n          if (itemSize >= 4) bufferAttribute.setW(index, sparseValues[i * itemSize + 3]);\n          if (itemSize >= 5)\n            throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');\n        }\n      }\n\n      return bufferAttribute;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n   * @param {number} textureIndex\n   * @return {Promise<THREE.Texture>}\n   */\n  GLTFParser.prototype.loadTexture = function (textureIndex) {\n    var parser = this;\n    var json = this.json;\n    var options = this.options;\n    var textureLoader = this.textureLoader;\n\n    var URL = self.URL || self.webkitURL;\n\n    var textureDef = json.textures[textureIndex];\n\n    var textureExtensions = textureDef.extensions || {};\n\n    var source;\n\n    if (textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]) {\n      source = json.images[textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS].source];\n    } else {\n      source = json.images[textureDef.source];\n    }\n\n    var sourceURI = source.uri;\n    var isObjectURL = false;\n\n    if (source.bufferView !== undefined) {\n      // Load binary image data from bufferView, if provided.\n\n      sourceURI = parser.getDependency('bufferView', source.bufferView).then(function (bufferView) {\n        isObjectURL = true;\n        var blob = new Blob([bufferView], { type: source.mimeType });\n        sourceURI = URL.createObjectURL(blob);\n        return sourceURI;\n      });\n    }\n\n    return Promise.resolve(sourceURI)\n      .then(function (sourceURI) {\n        // Load Texture resource.\n\n        var loader = options.manager.getHandler(sourceURI);\n\n        if (!loader) {\n          loader = textureExtensions[EXTENSIONS.MSFT_TEXTURE_DDS]\n            ? parser.extensions[EXTENSIONS.MSFT_TEXTURE_DDS].ddsLoader\n            : textureLoader;\n        }\n\n        return new Promise(function (resolve, reject) {\n          loader.load(resolveURL(sourceURI, options.path), resolve, undefined, reject);\n        });\n      })\n      .then(function (texture) {\n        // Clean up resources and configure Texture.\n\n        if (isObjectURL === true) {\n          URL.revokeObjectURL(sourceURI);\n        }\n\n        texture.flipY = false;\n\n        if (textureDef.name) texture.name = textureDef.name;\n\n        // Ignore unknown mime types, like DDS files.\n        if (source.mimeType in MIME_TYPE_FORMATS) {\n          texture.format = MIME_TYPE_FORMATS[source.mimeType];\n        }\n\n        var samplers = json.samplers || {};\n        var sampler = samplers[textureDef.sampler] || {};\n\n        texture.magFilter = WEBGL_FILTERS[sampler.magFilter] || LinearFilter;\n        texture.minFilter = WEBGL_FILTERS[sampler.minFilter] || LinearMipmapLinearFilter;\n        texture.wrapS = WEBGL_WRAPPINGS[sampler.wrapS] || RepeatWrapping;\n        texture.wrapT = WEBGL_WRAPPINGS[sampler.wrapT] || RepeatWrapping;\n\n        return texture;\n      });\n  };\n\n  /**\n   * Asynchronously assigns a texture to the given material parameters.\n   * @param {Object} materialParams\n   * @param {string} mapName\n   * @param {Object} mapDef\n   * @return {Promise}\n   */\n  GLTFParser.prototype.assignTexture = function (materialParams, mapName, mapDef) {\n    var parser = this;\n\n    return this.getDependency('texture', mapDef.index).then(function (texture) {\n      if (!texture.isCompressedTexture) {\n        switch (mapName) {\n          case 'aoMap':\n          case 'emissiveMap':\n          case 'metalnessMap':\n          case 'normalMap':\n          case 'roughnessMap':\n            texture.format = RGBFormat;\n            break;\n        }\n      }\n\n      // Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n      // However, we will copy UV set 0 to UV set 1 on demand for aoMap\n      if (\n        mapDef.texCoord !== undefined &&\n        mapDef.texCoord != 0 &&\n        !(mapName === 'aoMap' && mapDef.texCoord == 1)\n      ) {\n        console.warn(\n          'THREE.GLTFLoader: Custom UV set ' +\n          mapDef.texCoord +\n          ' for texture ' +\n          mapName +\n          ' not yet supported.'\n        );\n      }\n\n      if (parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]) {\n        var transform =\n              mapDef.extensions !== undefined\n                ? mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]\n                : undefined;\n\n        if (transform) {\n          texture = parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(\n            texture,\n            transform\n          );\n        }\n      }\n\n      materialParams[mapName] = texture;\n    });\n  };\n\n  /**\n   * Assigns final material to a Mesh, Line, or Points instance. The instance\n   * already has a material (generated from the glTF material options alone)\n   * but reuse of the same glTF material may require multiple threejs materials\n   * to accomodate different primitive types, defines, etc. New materials will\n   * be created if necessary, and reused from a cache.\n   * @param  {Object3D} mesh Mesh, Line, or Points instance.\n   */\n  GLTFParser.prototype.assignFinalMaterial = function (mesh) {\n    var geometry = mesh.geometry;\n    var material = mesh.material;\n\n    var useVertexTangents = geometry.attributes.tangent !== undefined;\n    var useVertexColors = geometry.attributes.color !== undefined;\n    var useFlatShading = geometry.attributes.normal === undefined;\n    var useSkinning = mesh.isSkinnedMesh === true;\n    var useMorphTargets = Object.keys(geometry.morphAttributes).length > 0;\n    var useMorphNormals = useMorphTargets && geometry.morphAttributes.normal !== undefined;\n\n    if (mesh.isPoints) {\n      var cacheKey = 'PointsMaterial:' + material.uuid;\n\n      var pointsMaterial = this.cache.get(cacheKey);\n\n      if (!pointsMaterial) {\n        pointsMaterial = new PointsMaterial();\n        Material.prototype.copy.call(pointsMaterial, material);\n        pointsMaterial.color.copy(material.color);\n        pointsMaterial.map = material.map;\n        pointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n        this.cache.add(cacheKey, pointsMaterial);\n      }\n\n      material = pointsMaterial;\n    } else if (mesh.isLine) {\n      var cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n      var lineMaterial = this.cache.get(cacheKey);\n\n      if (!lineMaterial) {\n        lineMaterial = new LineBasicMaterial();\n        Material.prototype.copy.call(lineMaterial, material);\n        lineMaterial.color.copy(material.color);\n\n        this.cache.add(cacheKey, lineMaterial);\n      }\n\n      material = lineMaterial;\n    }\n\n    // Clone the material if it will be modified\n    if (useVertexTangents || useVertexColors || useFlatShading || useSkinning || useMorphTargets) {\n      var cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n      if (material.isGLTFSpecularGlossinessMaterial) cacheKey += 'specular-glossiness:';\n      if (useSkinning) cacheKey += 'skinning:';\n      if (useVertexTangents) cacheKey += 'vertex-tangents:';\n      if (useVertexColors) cacheKey += 'vertex-colors:';\n      if (useFlatShading) cacheKey += 'flat-shading:';\n      if (useMorphTargets) cacheKey += 'morph-targets:';\n      if (useMorphNormals) cacheKey += 'morph-normals:';\n\n      var cachedMaterial = this.cache.get(cacheKey);\n\n      if (!cachedMaterial) {\n        cachedMaterial = material.clone();\n\n        if (useSkinning) cachedMaterial.skinning = true;\n        if (useVertexTangents) cachedMaterial.vertexTangents = true;\n        if (useVertexColors) cachedMaterial.vertexColors = true;\n        if (useFlatShading) cachedMaterial.flatShading = true;\n        if (useMorphTargets) cachedMaterial.morphTargets = true;\n        if (useMorphNormals) cachedMaterial.morphNormals = true;\n\n        this.cache.add(cacheKey, cachedMaterial);\n      }\n\n      material = cachedMaterial;\n    }\n\n    // workarounds for mesh and geometry\n\n    if (\n      material.aoMap &&\n      geometry.attributes.uv2 === undefined &&\n      geometry.attributes.uv !== undefined\n    ) {\n      geometry.setAttribute('uv2', geometry.attributes.uv);\n    }\n\n    // https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n    if (material.normalScale && !useVertexTangents) {\n      material.normalScale.y = -material.normalScale.y;\n    }\n\n    if (material.clearcoatNormalScale && !useVertexTangents) {\n      material.clearcoatNormalScale.y = -material.clearcoatNormalScale.y;\n    }\n\n    mesh.material = material;\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n   * @param {number} materialIndex\n   * @return {Promise<Material>}\n   */\n  GLTFParser.prototype.loadMaterial = function (materialIndex) {\n    var parser = this;\n    var json = this.json;\n    var extensions = this.extensions;\n    var materialDef = json.materials[materialIndex];\n\n    var materialType;\n    var materialParams = {};\n    var materialExtensions = materialDef.extensions || {};\n\n    var pending = [];\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]) {\n      var sgExtension = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];\n      materialType = sgExtension.getMaterialType();\n      pending.push(sgExtension.extendParams(materialParams, materialDef, parser));\n    } else if (materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]) {\n      var kmuExtension = extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];\n      materialType = kmuExtension.getMaterialType();\n      pending.push(kmuExtension.extendParams(materialParams, materialDef, parser));\n    } else {\n      // Specification:\n      // https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n      materialType = MeshStandardMaterial;\n\n      var metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n      materialParams.color = new Color(1.0, 1.0, 1.0);\n      materialParams.opacity = 1.0;\n\n      if (Array.isArray(metallicRoughness.baseColorFactor)) {\n        var array = metallicRoughness.baseColorFactor;\n\n        materialParams.color.fromArray(array);\n        materialParams.opacity = array[3];\n      }\n\n      if (metallicRoughness.baseColorTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(materialParams, 'map', metallicRoughness.baseColorTexture)\n        );\n      }\n\n      materialParams.metalness =\n        metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n      materialParams.roughness =\n        metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n      if (metallicRoughness.metallicRoughnessTexture !== undefined) {\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'metalnessMap',\n            metallicRoughness.metallicRoughnessTexture\n          )\n        );\n        pending.push(\n          parser.assignTexture(\n            materialParams,\n            'roughnessMap',\n            metallicRoughness.metallicRoughnessTexture\n          )\n        );\n      }\n    }\n\n    if (materialDef.doubleSided === true) {\n      materialParams.side = DoubleSide;\n    }\n\n    var alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n    if (alphaMode === ALPHA_MODES.BLEND) {\n      materialParams.transparent = true;\n\n      // See: https://github.com/mrdoob/three.js/issues/17706\n      materialParams.depthWrite = false;\n    } else {\n      materialParams.transparent = false;\n\n      if (alphaMode === ALPHA_MODES.MASK) {\n        materialParams.alphaTest =\n          materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n      }\n    }\n\n    if (materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'normalMap', materialDef.normalTexture));\n\n      materialParams.normalScale = new Vector2(1, 1);\n\n      if (materialDef.normalTexture.scale !== undefined) {\n        materialParams.normalScale.set(\n          materialDef.normalTexture.scale,\n          materialDef.normalTexture.scale\n        );\n      }\n    }\n\n    if (materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(parser.assignTexture(materialParams, 'aoMap', materialDef.occlusionTexture));\n\n      if (materialDef.occlusionTexture.strength !== undefined) {\n        materialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n      }\n    }\n\n    if (materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial) {\n      materialParams.emissive = new Color().fromArray(materialDef.emissiveFactor);\n    }\n\n    if (materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial) {\n      pending.push(\n        parser.assignTexture(materialParams, 'emissiveMap', materialDef.emissiveTexture)\n      );\n    }\n\n    if (materialExtensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT]) {\n      var clearcoatExtension = extensions[EXTENSIONS.KHR_MATERIALS_CLEARCOAT];\n      materialType = clearcoatExtension.getMaterialType();\n      pending.push(\n        clearcoatExtension.extendParams(materialParams, { extensions: materialExtensions }, parser)\n      );\n    }\n\n    return Promise.all(pending).then(function () {\n      var material;\n\n      if (materialType === GLTFMeshStandardSGMaterial) {\n        material = extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(\n          materialParams\n        );\n      } else {\n        material = new materialType(materialParams);\n      }\n\n      if (materialDef.name) material.name = materialDef.name;\n\n      // baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n      if (material.map) material.map.encoding = sRGBEncoding;\n      if (material.emissiveMap) material.emissiveMap.encoding = sRGBEncoding;\n\n      assignExtrasToUserData(material, materialDef);\n\n      if (materialDef.extensions) addUnknownExtensionsToUserData(extensions, material, materialDef);\n\n      return material;\n    });\n  };\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {GLTF.Primitive} primitiveDef\n   * @param {GLTFParser} parser\n   */\n  function computeBounds(geometry, primitiveDef, parser) {\n    var attributes = primitiveDef.attributes;\n\n    var box = new Box3();\n\n    if (attributes.POSITION !== undefined) {\n      var accessor = parser.json.accessors[attributes.POSITION];\n\n      var min = accessor.min;\n      var max = accessor.max;\n\n      // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n      if (min !== undefined && max !== undefined) {\n        box.set(new Vector3(min[0], min[1], min[2]), new Vector3(max[0], max[1], max[2]));\n      } else {\n        console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n\n        return;\n      }\n    } else {\n      return;\n    }\n\n    var targets = primitiveDef.targets;\n\n    if (targets !== undefined) {\n      var maxDisplacement = new Vector3();\n      var vector = new Vector3();\n\n      for (var i = 0, il = targets.length; i < il; i++) {\n        var target = targets[i];\n\n        if (target.POSITION !== undefined) {\n          var accessor = parser.json.accessors[target.POSITION];\n          var min = accessor.min;\n          var max = accessor.max;\n\n          // glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n          if (min !== undefined && max !== undefined) {\n            // we need to get max of absolute components because target weight is [-1,1]\n            vector.setX(Math.max(Math.abs(min[0]), Math.abs(max[0])));\n            vector.setY(Math.max(Math.abs(min[1]), Math.abs(max[1])));\n            vector.setZ(Math.max(Math.abs(min[2]), Math.abs(max[2])));\n\n            // Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n            // to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n            // are used to implement key-frame animations and as such only two are active at a time - this results in very large\n            // boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n            maxDisplacement.max(vector);\n          } else {\n            console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');\n          }\n        }\n      }\n\n      // As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n      box.expandByVector(maxDisplacement);\n    }\n\n    geometry.boundingBox = box;\n\n    var sphere = new Sphere();\n\n    box.getCenter(sphere.center);\n    sphere.radius = box.min.distanceTo(box.max) / 2;\n\n    geometry.boundingSphere = sphere;\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {GLTF.Primitive} primitiveDef\n   * @param {GLTFParser} parser\n   * @return {Promise<BufferGeometry>}\n   */\n  function addPrimitiveAttributes(geometry, primitiveDef, parser) {\n    var attributes = primitiveDef.attributes;\n\n    var pending = [];\n\n    function assignAttributeAccessor(accessorIndex, attributeName) {\n      return parser.getDependency('accessor', accessorIndex).then(function (accessor) {\n        geometry.setAttribute(attributeName, accessor);\n      });\n    }\n\n    for (var gltfAttributeName in attributes) {\n      var threeAttributeName = ATTRIBUTES[gltfAttributeName] || gltfAttributeName.toLowerCase();\n\n      // Skip attributes already provided by e.g. Draco extension.\n      if (threeAttributeName in geometry.attributes) continue;\n\n      pending.push(assignAttributeAccessor(attributes[gltfAttributeName], threeAttributeName));\n    }\n\n    if (primitiveDef.indices !== undefined && !geometry.index) {\n      var accessor = parser\n        .getDependency('accessor', primitiveDef.indices)\n        .then(function (accessor) {\n          geometry.setIndex(accessor);\n        });\n\n      pending.push(accessor);\n    }\n\n    assignExtrasToUserData(geometry, primitiveDef);\n\n    computeBounds(geometry, primitiveDef, parser);\n\n    return Promise.all(pending).then(function () {\n      return primitiveDef.targets !== undefined\n        ? addMorphTargets(geometry, primitiveDef.targets, parser)\n        : geometry;\n    });\n  }\n\n  /**\n   * @param {BufferGeometry} geometry\n   * @param {Number} drawMode\n   * @return {BufferGeometry}\n   */\n  function toTrianglesDrawMode(geometry, drawMode) {\n    var index = geometry.getIndex();\n\n    // generate index if not present\n\n    if (index === null) {\n      var indices = [];\n\n      var position = geometry.getAttribute('position');\n\n      if (position !== undefined) {\n        for (var i = 0; i < position.count; i++) {\n          indices.push(i);\n        }\n\n        geometry.setIndex(indices);\n        index = geometry.getIndex();\n      } else {\n        console.error(\n          'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.'\n        );\n        return geometry;\n      }\n    }\n\n    //\n\n    var numberOfTriangles = index.count - 2;\n    var newIndices = [];\n\n    if (drawMode === TriangleFanDrawMode) {\n      // gl.TRIANGLE_FAN\n\n      for (var i = 1; i <= numberOfTriangles; i++) {\n        newIndices.push(index.getX(0));\n        newIndices.push(index.getX(i));\n        newIndices.push(index.getX(i + 1));\n      }\n    } else {\n      // gl.TRIANGLE_STRIP\n\n      for (var i = 0; i < numberOfTriangles; i++) {\n        if (i % 2 === 0) {\n          newIndices.push(index.getX(i));\n          newIndices.push(index.getX(i + 1));\n          newIndices.push(index.getX(i + 2));\n        } else {\n          newIndices.push(index.getX(i + 2));\n          newIndices.push(index.getX(i + 1));\n          newIndices.push(index.getX(i));\n        }\n      }\n    }\n\n    if (newIndices.length / 3 !== numberOfTriangles) {\n      console.error(\n        'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.'\n      );\n    }\n\n    // build final geometry\n\n    var newGeometry = geometry.clone();\n    newGeometry.setIndex(newIndices);\n\n    return newGeometry;\n  }\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n   *\n   * Creates BufferGeometries from primitives.\n   *\n   * @param {Array<GLTF.Primitive>} primitives\n   * @return {Promise<Array<BufferGeometry>>}\n   */\n  GLTFParser.prototype.loadGeometries = function (primitives) {\n    var parser = this;\n    var extensions = this.extensions;\n    var cache = this.primitiveCache;\n\n    function createDracoPrimitive(primitive) {\n      return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]\n        .decodePrimitive(primitive, parser)\n        .then(function (geometry) {\n          return addPrimitiveAttributes(geometry, primitive, parser);\n        });\n    }\n\n    var pending = [];\n\n    for (var i = 0, il = primitives.length; i < il; i++) {\n      var primitive = primitives[i];\n      var cacheKey = createPrimitiveKey(primitive);\n\n      // See if we've already created this geometry\n      var cached = cache[cacheKey];\n\n      if (cached) {\n        // Use the cached geometry if it exists\n        pending.push(cached.promise);\n      } else {\n        var geometryPromise;\n\n        if (primitive.extensions && primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]) {\n          // Use DRACO geometry if available\n          geometryPromise = createDracoPrimitive(primitive);\n        } else {\n          // Otherwise create a new geometry\n          geometryPromise = addPrimitiveAttributes(new BufferGeometry(), primitive, parser);\n        }\n\n        // Cache this geometry\n        cache[cacheKey] = { primitive: primitive, promise: geometryPromise };\n\n        pending.push(geometryPromise);\n      }\n    }\n\n    return Promise.all(pending);\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n   * @param {number} meshIndex\n   * @return {Promise<Group|Mesh|SkinnedMesh>}\n   */\n  GLTFParser.prototype.loadMesh = function (meshIndex) {\n    var parser = this;\n    var json = this.json;\n\n    var meshDef = json.meshes[meshIndex];\n    var primitives = meshDef.primitives;\n\n    var pending = [];\n\n    for (var i = 0, il = primitives.length; i < il; i++) {\n      var material =\n            primitives[i].material === undefined\n              ? createDefaultMaterial(this.cache)\n              : this.getDependency('material', primitives[i].material);\n\n      pending.push(material);\n    }\n\n    pending.push(parser.loadGeometries(primitives));\n\n    return Promise.all(pending).then(function (results) {\n      var materials = results.slice(0, results.length - 1);\n      var geometries = results[results.length - 1];\n\n      var meshes = [];\n\n      for (var i = 0, il = geometries.length; i < il; i++) {\n        var geometry = geometries[i];\n        var primitive = primitives[i];\n\n        // 1. create Mesh\n\n        var mesh;\n\n        var material = materials[i];\n\n        if (\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n          primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n          primitive.mode === undefined\n        ) {\n          // .isSkinnedMesh isn't in glTF spec. See .markDefs()\n          mesh =\n            meshDef.isSkinnedMesh === true\n              ? new SkinnedMesh(geometry, material)\n              : new Mesh(geometry, material);\n\n          if (mesh.isSkinnedMesh === true && !mesh.geometry.attributes.skinWeight.normalized) {\n            // we normalize floating point skin weight array to fix malformed assets (see #15319)\n            // it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n            mesh.normalizeSkinWeights();\n          }\n\n          if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleStripDrawMode);\n          } else if (primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN) {\n            mesh.geometry = toTrianglesDrawMode(mesh.geometry, TriangleFanDrawMode);\n          }\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINES) {\n          mesh = new LineSegments(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_STRIP) {\n          mesh = new Line(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.LINE_LOOP) {\n          mesh = new LineLoop(geometry, material);\n        } else if (primitive.mode === WEBGL_CONSTANTS.POINTS) {\n          mesh = new Points(geometry, material);\n        } else {\n          throw new Error('THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode);\n        }\n\n        if (Object.keys(mesh.geometry.morphAttributes).length > 0) {\n          updateMorphTargets(mesh, meshDef);\n        }\n\n        mesh.name = meshDef.name || 'mesh_' + meshIndex;\n\n        if (geometries.length > 1) mesh.name += '_' + i;\n\n        assignExtrasToUserData(mesh, meshDef);\n\n        parser.assignFinalMaterial(mesh);\n\n        meshes.push(mesh);\n      }\n\n      if (meshes.length === 1) {\n        return meshes[0];\n      }\n\n      var group = new Group();\n\n      for (var i = 0, il = meshes.length; i < il; i++) {\n        group.add(meshes[i]);\n      }\n\n      return group;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n   * @param {number} cameraIndex\n   * @return {Promise<THREE.Camera>}\n   */\n  GLTFParser.prototype.loadCamera = function (cameraIndex) {\n    var camera;\n    var cameraDef = this.json.cameras[cameraIndex];\n    var params = cameraDef[cameraDef.type];\n\n    if (!params) {\n      console.warn('THREE.GLTFLoader: Missing camera parameters.');\n      return;\n    }\n\n    if (cameraDef.type === 'perspective') {\n      camera = new PerspectiveCamera(\n        MathUtils.radToDeg(params.yfov),\n        params.aspectRatio || 1,\n        params.znear || 1,\n        params.zfar || 2e6\n      );\n    } else if (cameraDef.type === 'orthographic') {\n      camera = new OrthographicCamera(\n        -params.xmag,\n        params.xmag,\n        params.ymag,\n        -params.ymag,\n        params.znear,\n        params.zfar\n      );\n    }\n\n    if (cameraDef.name) camera.name = cameraDef.name;\n\n    assignExtrasToUserData(camera, cameraDef);\n\n    return Promise.resolve(camera);\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n   * @param {number} skinIndex\n   * @return {Promise<Object>}\n   */\n  GLTFParser.prototype.loadSkin = function (skinIndex) {\n    var skinDef = this.json.skins[skinIndex];\n\n    var skinEntry = { joints: skinDef.joints };\n\n    if (skinDef.inverseBindMatrices === undefined) {\n      return Promise.resolve(skinEntry);\n    }\n\n    return this.getDependency('accessor', skinDef.inverseBindMatrices).then(function (accessor) {\n      skinEntry.inverseBindMatrices = accessor;\n\n      return skinEntry;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n   * @param {number} animationIndex\n   * @return {Promise<AnimationClip>}\n   */\n  GLTFParser.prototype.loadAnimation = function (animationIndex) {\n    var json = this.json;\n\n    var animationDef = json.animations[animationIndex];\n\n    var pendingNodes = [];\n    var pendingInputAccessors = [];\n    var pendingOutputAccessors = [];\n    var pendingSamplers = [];\n    var pendingTargets = [];\n\n    for (var i = 0, il = animationDef.channels.length; i < il; i++) {\n      var channel = animationDef.channels[i];\n      var sampler = animationDef.samplers[channel.sampler];\n      var target = channel.target;\n      var name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n      var input =\n            animationDef.parameters !== undefined\n              ? animationDef.parameters[sampler.input]\n              : sampler.input;\n      var output =\n            animationDef.parameters !== undefined\n              ? animationDef.parameters[sampler.output]\n              : sampler.output;\n\n      pendingNodes.push(this.getDependency('node', name));\n      pendingInputAccessors.push(this.getDependency('accessor', input));\n      pendingOutputAccessors.push(this.getDependency('accessor', output));\n      pendingSamplers.push(sampler);\n      pendingTargets.push(target);\n    }\n\n    return Promise.all([\n      Promise.all(pendingNodes),\n      Promise.all(pendingInputAccessors),\n      Promise.all(pendingOutputAccessors),\n      Promise.all(pendingSamplers),\n      Promise.all(pendingTargets),\n    ]).then(function (dependencies) {\n      var nodes = dependencies[0];\n      var inputAccessors = dependencies[1];\n      var outputAccessors = dependencies[2];\n      var samplers = dependencies[3];\n      var targets = dependencies[4];\n\n      var tracks = [];\n\n      for (var i = 0, il = nodes.length; i < il; i++) {\n        var node = nodes[i];\n        var inputAccessor = inputAccessors[i];\n        var outputAccessor = outputAccessors[i];\n        var sampler = samplers[i];\n        var target = targets[i];\n\n        if (node === undefined) continue;\n\n        node.updateMatrix();\n        node.matrixAutoUpdate = true;\n\n        var TypedKeyframeTrack;\n\n        switch (PATH_PROPERTIES[target.path]) {\n          case PATH_PROPERTIES.weights:\n            TypedKeyframeTrack = NumberKeyframeTrack;\n            break;\n\n          case PATH_PROPERTIES.rotation:\n            TypedKeyframeTrack = QuaternionKeyframeTrack;\n            break;\n\n          case PATH_PROPERTIES.position:\n          case PATH_PROPERTIES.scale:\n          default:\n            TypedKeyframeTrack = VectorKeyframeTrack;\n            break;\n        }\n\n        var targetName = node.name ? node.name : node.uuid;\n\n        var interpolation =\n              sampler.interpolation !== undefined\n                ? INTERPOLATION[sampler.interpolation]\n                : InterpolateLinear;\n\n        var targetNames = [];\n\n        if (PATH_PROPERTIES[target.path] === PATH_PROPERTIES.weights) {\n          // Node may be a Group (glTF mesh with several primitives) or a Mesh.\n          node.traverse(function (object) {\n            if (object.isMesh === true && object.morphTargetInfluences) {\n              targetNames.push(object.name ? object.name : object.uuid);\n            }\n          });\n        } else {\n          targetNames.push(targetName);\n        }\n\n        var outputArray = outputAccessor.array;\n\n        if (outputAccessor.normalized) {\n          var scale;\n\n          if (outputArray.constructor === Int8Array) {\n            scale = 1 / 127;\n          } else if (outputArray.constructor === Uint8Array) {\n            scale = 1 / 255;\n          } else if (outputArray.constructor == Int16Array) {\n            scale = 1 / 32767;\n          } else if (outputArray.constructor === Uint16Array) {\n            scale = 1 / 65535;\n          } else {\n            throw new Error('THREE.GLTFLoader: Unsupported output accessor component type.');\n          }\n\n          var scaled = new Float32Array(outputArray.length);\n\n          for (var j = 0, jl = outputArray.length; j < jl; j++) {\n            scaled[j] = outputArray[j] * scale;\n          }\n\n          outputArray = scaled;\n        }\n\n        for (var j = 0, jl = targetNames.length; j < jl; j++) {\n          var track = new TypedKeyframeTrack(\n            targetNames[j] + '.' + PATH_PROPERTIES[target.path],\n            inputAccessor.array,\n            outputArray,\n            interpolation\n          );\n\n          // Override interpolation with custom factory method.\n          if (sampler.interpolation === 'CUBICSPLINE') {\n            track.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline(result) {\n              // A CUBICSPLINE keyframe in glTF has three output values for each input value,\n              // representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n              // must be divided by three to get the interpolant's sampleSize argument.\n\n              return new GLTFCubicSplineInterpolant(\n                this.times,\n                this.values,\n                this.getValueSize() / 3,\n                result\n              );\n            };\n\n            // Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n            track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n          }\n\n          tracks.push(track);\n        }\n      }\n\n      var name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n      return new AnimationClip(name, undefined, tracks);\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n   * @param {number} nodeIndex\n   * @return {Promise<Object3D>}\n   */\n  GLTFParser.prototype.loadNode = function (nodeIndex) {\n    var json = this.json;\n    var extensions = this.extensions;\n    var parser = this;\n\n    var meshReferences = json.meshReferences;\n    var meshUses = json.meshUses;\n\n    var nodeDef = json.nodes[nodeIndex];\n\n    return (function () {\n      var pending = [];\n\n      if (nodeDef.mesh !== undefined) {\n        pending.push(\n          parser.getDependency('mesh', nodeDef.mesh).then(function (mesh) {\n            var node;\n\n            if (meshReferences[nodeDef.mesh] > 1) {\n              var instanceNum = meshUses[nodeDef.mesh]++;\n\n              node = mesh.clone();\n              node.name += '_instance_' + instanceNum;\n            } else {\n              node = mesh;\n            }\n\n            // if weights are provided on the node, override weights on the mesh.\n            if (nodeDef.weights !== undefined) {\n              node.traverse(function (o) {\n                if (!o.isMesh) return;\n\n                for (var i = 0, il = nodeDef.weights.length; i < il; i++) {\n                  o.morphTargetInfluences[i] = nodeDef.weights[i];\n                }\n              });\n            }\n\n            return node;\n          })\n        );\n      }\n\n      if (nodeDef.camera !== undefined) {\n        pending.push(parser.getDependency('camera', nodeDef.camera));\n      }\n\n      if (\n        nodeDef.extensions &&\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL] &&\n        nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light !== undefined\n      ) {\n        pending.push(\n          parser.getDependency('light', nodeDef.extensions[EXTENSIONS.KHR_LIGHTS_PUNCTUAL].light)\n        );\n      }\n\n      return Promise.all(pending);\n    })().then(function (objects) {\n      var node;\n\n      // .isBone isn't in glTF spec. See .markDefs\n      if (nodeDef.isBone === true) {\n        node = new Bone();\n      } else if (objects.length > 1) {\n        node = new Group();\n      } else if (objects.length === 1) {\n        node = objects[0];\n      } else {\n        node = new Object3D();\n      }\n\n      if (node !== objects[0]) {\n        for (var i = 0, il = objects.length; i < il; i++) {\n          node.add(objects[i]);\n        }\n      }\n\n      if (nodeDef.name) {\n        node.userData.name = nodeDef.name;\n        node.name = PropertyBinding.sanitizeNodeName(nodeDef.name);\n      }\n\n      assignExtrasToUserData(node, nodeDef);\n\n      if (nodeDef.extensions) addUnknownExtensionsToUserData(extensions, node, nodeDef);\n\n      if (nodeDef.matrix !== undefined) {\n        var matrix = new Matrix4();\n        matrix.fromArray(nodeDef.matrix);\n        node.applyMatrix4(matrix);\n      } else {\n        if (nodeDef.translation !== undefined) {\n          node.position.fromArray(nodeDef.translation);\n        }\n\n        if (nodeDef.rotation !== undefined) {\n          node.quaternion.fromArray(nodeDef.rotation);\n        }\n\n        if (nodeDef.scale !== undefined) {\n          node.scale.fromArray(nodeDef.scale);\n        }\n      }\n\n      return node;\n    });\n  };\n\n  /**\n   * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n   * @param {number} sceneIndex\n   * @return {Promise<Group>}\n   */\n  GLTFParser.prototype.loadScene = (function () {\n    // scene node hierachy builder\n\n    function buildNodeHierachy(nodeId, parentObject, json, parser) {\n      var nodeDef = json.nodes[nodeId];\n\n      return parser\n        .getDependency('node', nodeId)\n        .then(function (node) {\n          if (nodeDef.skin === undefined) return node;\n\n          // build skeleton here as well\n\n          var skinEntry;\n\n          return parser\n            .getDependency('skin', nodeDef.skin)\n            .then(function (skin) {\n              skinEntry = skin;\n\n              var pendingJoints = [];\n\n              for (var i = 0, il = skinEntry.joints.length; i < il; i++) {\n                pendingJoints.push(parser.getDependency('node', skinEntry.joints[i]));\n              }\n\n              return Promise.all(pendingJoints);\n            })\n            .then(function (jointNodes) {\n              node.traverse(function (mesh) {\n                if (!mesh.isMesh) return;\n\n                var bones = [];\n                var boneInverses = [];\n\n                for (var j = 0, jl = jointNodes.length; j < jl; j++) {\n                  var jointNode = jointNodes[j];\n\n                  if (jointNode) {\n                    bones.push(jointNode);\n\n                    var mat = new Matrix4();\n\n                    if (skinEntry.inverseBindMatrices !== undefined) {\n                      mat.fromArray(skinEntry.inverseBindMatrices.array, j * 16);\n                    }\n\n                    boneInverses.push(mat);\n                  } else {\n                    console.warn(\n                      'THREE.GLTFLoader: Joint \"%s\" could not be found.',\n                      skinEntry.joints[j]\n                    );\n                  }\n                }\n\n                mesh.bind(new Skeleton(bones, boneInverses), mesh.matrixWorld);\n              });\n\n              return node;\n            });\n        })\n        .then(function (node) {\n          // build node hierachy\n\n          parentObject.add(node);\n\n          var pending = [];\n\n          if (nodeDef.children) {\n            var children = nodeDef.children;\n\n            for (var i = 0, il = children.length; i < il; i++) {\n              var child = children[i];\n              pending.push(buildNodeHierachy(child, node, json, parser));\n            }\n          }\n\n          return Promise.all(pending);\n        });\n    }\n\n    return function loadScene(sceneIndex) {\n      var json = this.json;\n      var extensions = this.extensions;\n      var sceneDef = this.json.scenes[sceneIndex];\n      var parser = this;\n\n      // Loader returns Group, not Scene.\n      // See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n      var scene = new Group();\n      if (sceneDef.name) scene.name = sceneDef.name;\n\n      assignExtrasToUserData(scene, sceneDef);\n\n      if (sceneDef.extensions) addUnknownExtensionsToUserData(extensions, scene, sceneDef);\n\n      var nodeIds = sceneDef.nodes || [];\n\n      var pending = [];\n\n      for (var i = 0, il = nodeIds.length; i < il; i++) {\n        pending.push(buildNodeHierachy(nodeIds[i], scene, json, parser));\n      }\n\n      return Promise.all(pending).then(function () {\n        return scene;\n      });\n    };\n  })();\n\n  return GLTFLoader;\n})();\n\nexport { GLTFLoader };\n","const ALIAS = {\n  'left'\t\t: 37,\n  'up'\t\t  : 38,\n  'right'\t\t: 39,\n  'down'\t\t: 40,\n  'space'\t\t: 32,\n  'tab'\t\t  : 9,\n  'escape'\t: 27\n};\n\nexport default class Keyboard {\n  constructor(domElement) {\n    this.domElement = domElement || document;\n    this.keyCodes = {};\n\n    // bind keyEvents\n    this.domElement.addEventListener('keydown', (event) => this.onKeyChange(event), false);\n    this.domElement.addEventListener('keyup', (event) => this.onKeyChange(event), false);\n\n    // bind window blur\n    window.addEventListener('blur', () => this.onBlur, false);\n  }\n\n  destroy() {\n    this.domElement.removeEventListener('keydown', (event) => this.onKeyChange(event), false);\n    this.domElement.removeEventListener('keyup', (event) => this.onKeyChange(event), false);\n\n    // unbind window blur event\n    window.removeEventListener('blur', () => this.onBlur, false);\n  }\n\n  onBlur() {\n    for(const prop in this.keyCodes)\n      this.keyCodes[prop] = false;\n  }\n\n  onKeyChange(event) {\n    // log to debug\n    //console.log('onKeyChange', event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\n\n    // update this.keyCodes\n    const keyCode = event.keyCode;\n    this.keyCodes[keyCode] = event.type === 'keydown';\n  }\n\n  pressed(keyDesc) {\n    const keys = keyDesc.split('+');\n    for(let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      let pressed = false;\n      if(Object.keys(ALIAS).indexOf(key) != -1) {\n        pressed = this.keyCodes[ALIAS[key]];\n      } else {\n        pressed = this.keyCodes[key.toUpperCase().charCodeAt(0)];\n      }\n      if(!pressed)\n        return false;\n    }\n\n    return true;\n  }\n\n  eventMatches(event, keyDesc) {\n    const aliases = ALIAS;\n    const aliasKeys = Object.keys(aliases);\n    const keys = keyDesc.split('+');\n    // log to debug\n    // console.log('eventMatches', event, event.keyCode, event.shiftKey, event.ctrlKey, event.altKey, event.metaKey)\n    for(let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n      let pressed = false;\n      if(key === 'shift') {\n        pressed = event.shiftKey ? true : false;\n      } else if(key === 'ctrl') {\n        pressed = event.ctrlKey ? true : false;\n      } else if(key === 'alt') {\n        pressed = event.altKey ? true : false;\n      } else if(key === 'meta') {\n        pressed = event.metaKey ? true : false;\n      } else if(aliasKeys.indexOf(key) !== -1) {\n        pressed = event.keyCode === aliases[key];\n      } else if(event.keyCode === key.toUpperCase().charCodeAt(0)) {\n        pressed = true;\n      }\n      if(!pressed)\n        return false;\n    }\n\n    return true;\n  }\n}\n","import Keyboard from '../../utils/keyboard';\nimport Helpers from '../../utils/helpers';\nimport Config from '../../data/config';\n\n// Manages all input interactions\nexport default class Interaction {\n  constructor(renderer, scene, camera, controls) {\n    // Properties\n    this.renderer = renderer;\n    this.scene = scene;\n    this.camera = camera;\n    this.controls = controls;\n\n    this.timeout = null;\n\n    // Instantiate keyboard helper\n    this.keyboard = new Keyboard();\n\n    // Listeners\n    // Mouse events\n    this.renderer.domElement.addEventListener('mousemove', (event) => Helpers.throttle(this.onMouseMove(event), 250), false);\n    this.renderer.domElement.addEventListener('mouseleave', (event) => this.onMouseLeave(event), false);\n    this.renderer.domElement.addEventListener('mouseover', (event) => this.onMouseOver(event), false);\n\n    // Keyboard events\n    this.keyboard.domElement.addEventListener('keydown', (event) => {\n      // Only once\n      if(event.repeat) {\n        return;\n      }\n\n      if(this.keyboard.eventMatches(event, 'escape')) {\n        console.log('Escape pressed');\n      }\n    });\n  }\n\n  onMouseOver(event) {\n    event.preventDefault();\n\n    Config.isMouseOver = true;\n  }\n\n  onMouseLeave(event) {\n    event.preventDefault();\n\n    Config.isMouseOver = false;\n  }\n\n  onMouseMove(event) {\n    event.preventDefault();\n\n    clearTimeout(this.timeout);\n\n    this.timeout = setTimeout(function() {\n      Config.isMouseMoving = false;\n    }, 200);\n\n    Config.isMouseMoving = true;\n  }\n}\n","\nimport * as THREE from 'three';\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\nimport MQTT from 'paho-mqtt';\n\nconst mqtt_server = \"68.183.188.135\";\nconst mqtt_port = 9001;\n\nconst TOPIC_INFO = 'v1/localization/info';\nconst TOPIC_CREATE = 'v1/gui/create';\nconst TOPIC_CHANGE_COLOR = 'v1/sensor/color';\n\nexport default class MQTTClient {\n\n    constructor(scene, robot) {\n\n        this.scene = scene;\n        this.robot = robot;\n\n        const client_id = 'client_' + Math.random().toString(36).substring(2, 15);\n        this.client = new MQTT.Client(mqtt_server, mqtt_port, \"\", client_id);\n\n        this.client.connect({\n            userName: \"swarm_user\",\n            password: \"swarm_usere15\",\n            reconnect: true,\n            onSuccess: () => {\n                console.log('MQTT: connected');\n\n                // Subscribe to topics\n                this.client.subscribe(TOPIC_INFO);\n                this.client.subscribe(TOPIC_CREATE);\n                this.client.subscribe(TOPIC_CHANGE_COLOR);\n\n                window.robot = this.robot;\n                this.client.onMessageArrived = this.onMessageArrived;\n                this.client.onConnectionLost = this.onConnectionLost;\n            }\n        });\n    }\n\n    onConnectionLost(responseObject) {\n        if (responseObject.errorCode !== 0) {\n            console.log(\"MQTT: onConnectionLost:\" + responseObject.errorMessage);\n            console.log('MQTT: reconnecting');\n        }\n    }\n\n    onMessageArrived(packet) {\n        const msg = packet.payloadString.trim();\n        const topic = packet.destinationName;\n\n        if (topic == TOPIC_CREATE) {\n            //console.log('MQTT: ' + topic + ' > ' + msg);\n\n            try {\n                var data = JSON.parse(msg);\n                window.robot.create(data.id, data.x, data.y, data.heading)\n            } catch (e) {\n                console.error(e);\n            }\n\n        } else if (topic == TOPIC_INFO) {\n            //console.log('MQTT: ' + topic + ' > ' + msg);\n            try {\n                var data = JSON.parse(msg);\n\n                Object.entries(data).forEach(entry => {\n                    // Update each robot\n                    //console.log(entry[1]);\n                    const r = entry[1];\n\n                    if(window.robot.exists(r.id)==undefined){\n                        window.robot.create(r.id, r.x, r.y, r.heading);\n                    }else{\n                        window.robot.move(r.id, r.x, r.y, r.heading);\n                    }\n                });\n            } catch (e) {\n                console.error(e);\n            }\n        } else if (topic == TOPIC_CHANGE_COLOR) {\n            try {\n                var data = JSON.parse(msg);\n                window.robot.changeColor(data.id, data.R, data.G, data.B, data.ambient);\n                //console.log('R: '+data.R+ ' G: '+data.G+ ' B: '+data.B);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n    }\n\n    publish(topic, message, callback) {\n        var payload = new MQTT.Message(message);\n        payload.destinationName = topic;\n        this.client.send(payload);\n        console.log('MQTT: published');\n\n        if (callback != null) callback();\n    }\n\n}\n","import * as THREE from 'three';\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\nvar STLLoader = require('three-stl-loader')(THREE)\n//var scene;\n\nconst TOPIC_INFO = 'v1/localization/info';\nconst TOPIC_CREATE = 'v1/gui/create';\n\nexport default class Robot {\n    constructor(scene) {\n        this.scene = scene;\n    }\n\n    changeColor(id, R, G, B, ambient, callback) {\n        var r = this.scene.getObjectByName(\"id_\" + id);\n        if (r != undefined) {\n            r.material.color.setRGB(R/256, G/256, B/265);\n            if (callback != null) callback('success');\n        } else {\n            if (callback != null) callback('undefined');\n        }\n\n        return r;\n    }\n\n    create(id, x, y, heading, callback) {\n        var r = this.scene.getObjectByName(\"id_\" + id);\n        if (r == undefined) {\n            // Create only if not exists\n            var loader = new STLLoader();\n            loader.load('./assets/models/model.stl', function (geometry, scene) {\n                var material = new THREE.MeshStandardMaterial({ color: 0x5877d2 });\n\n                var r = new THREE.Mesh(geometry, material);\n                r.receiveShadow = true;\n                r.name = \"id_\" + id;\n                r.position.set(x, 0, y);\n                r.rotation.y = heading * THREE.Math.DEG2RAD;\n                window.scene.add(r);\n\n                console.log('Created:', id);\n\n                // Callback function\n                if (callback != null) callback('success');\n            });\n        } else {\n            if (callback != null) callback('already defined');\n        }\n        return r;\n    }\n\n    exists(id){\n        var r = this.scene.getObjectByName(\"id_\" + id);\n        return r;\n    }\n\n    move(id, x, y, heading, callback) {\n        var r = this.scene.getObjectByName(\"id_\" + id);\n        if (r != undefined) {\n            const newHeading = heading * THREE.Math.DEG2RAD;\n            var position = { x: r.position.x, y: r.position.z, heading: r.rotation.y };\n\n            x = Math.round(x*10)/10;\n            y = Math.round(y*10)/10;\n            heading = Math.round(heading*10)/10;\n\n            const speed = 10;\n            const distance = 10;//Math.sqrt(Math.pow(x - position.x, 2) + Math.pow(y - position.y, 2));\n\n            // TODO: If distance is 0, need to handle only the rotation\n\n            if (distance != 0) {\n                var tween = new TWEEN.Tween(position).to({ x: x, y: y, heading: newHeading }, 1000 * (distance / speed))\n                /*.easing(TWEEN.Easing.Quartic.InOut)*/\n                .onUpdate(function () {\n                    r.position.x = position.x;\n                    r.position.z = position.y;\n                    r.rotation.y = position.heading;\n\n                }).onComplete(() => {\n                    console.log('Move:',id,'x:',x,'y:',y,'heading',heading);\n                    if (callback != null) callback('success');\n\n                }).delay(50).start();\n            } else {\n                // No move, only the rotation\n                r.rotation.y = newHeading;\n            }\n            return r;\n\n        } else {\n            if (callback != null) callback('undefined');\n        }\n    }\n\n    get_coordinates(id) {\n        var r = this.scene.getObjectByName(\"id_\" + id);\n        if (r != undefined) {\n            console.log(`${r.position.x},${r.position.y},${r.position.z}`);\n            return r;\n        } else {\n            return null;\n        }\n    }\n\n    update() {\n        TWEEN.update();\n    }\n}\n","// Global imports -\nimport * as THREE from 'three';\nimport TWEEN, { update } from '@tweenjs/tween.js';\n\n// Components\nimport Renderer from './components/renderer';\nimport Camera from './components/camera';\nimport Light from './components/light';\nimport Controls from './components/controls';\nimport Geometry from './components/geometry';\n\n// Helpers\nimport Stats from './helpers/stats';\nimport MeshHelper from './helpers/meshHelper';\n\n// Model\nimport Texture from './model/texture';\nimport Model from './model/model';\n\n// Managers\nimport Interaction from './managers/interaction';\nimport DatGUI from './managers/datGUI';\n\n// Implemented by Nuwan\nimport MQTTClient from './managers/mqttClient';\nimport Robot from './components/robot';\n\n// data\nimport Config from './../data/config';\n// -- End of imports\n\n//STLLoader - Updated by Nuwan\nvar STLLoader = require('three-stl-loader')(THREE)\n\n// This class instantiates and ties all of the components together, starts the loading process and renders the main loop\nexport default class Main {\n   constructor(container) {\n\n      // Set container property to container element\n      this.container = container;\n\n      // Start Three clock\n      this.clock = new THREE.Clock();\n\n      // Main scene creation\n      this.scene = new THREE.Scene();\n      window.scene = this.scene; // config as a global variable\n\n      this.scene.fog = new THREE.FogExp2(Config.fog.color, Config.fog.near);\n\n      // Defined by Nuwan\n      this.robot = new Robot(this.scene);\n      this.mqtt = new MQTTClient(this.scene, this.robot);\n\n      // Get Device Pixel Ratio first for retina\n      if (window.devicePixelRatio) {\n         Config.dpr = window.devicePixelRatio;\n      }\n\n      // Main renderer constructor\n      this.renderer = new Renderer(this.scene, container);\n\n      // Components instantiations\n      this.camera = new Camera(this.renderer.threeRenderer);\n      this.controls = new Controls(this.camera.threeCamera, container);\n      this.light = new Light(this.scene);\n\n      // Create and place lights in scene\n      const lights = ['ambient', 'directional', 'point', 'hemi'];\n      lights.forEach((light) => this.light.place(light));\n\n      // Set up rStats if dev environment\n      if (Config.isDev && Config.isShowingStats) {\n         this.stats = new Stats(this.renderer);\n         this.stats.setUp();\n      }\n\n      // Set up gui\n      //if (Config.isDev) {\n      //   this.gui = new DatGUI(this)\n      //}\n\n      // Instantiate texture class\n      this.texture = new Texture();\n\n      // Start loading the textures and then go on to load the model after the texture Promises have resolved\n      this.texture.load().then(() => {\n         this.manager = new THREE.LoadingManager();\n\n         // Textures loaded, load model\n         //this.model = new Model(this.scene, this.manager, this.texture.textures);\n         //this.model.load(Config.models[Config.model.selected].type);\n\n         // Create the environment ---------------------------------------------\n         var geometry = new THREE.PlaneBufferGeometry(200, 200);\n         var material = new THREE.MeshPhongMaterial({ color: 0x999999, depthWrite: false });\n         var ground = new THREE.Mesh(geometry, material);\n         ground.position.set(0, 0, 0);\n         ground.rotation.x = - Math.PI / 2;\n         ground.receiveShadow = true;\n         this.scene.add(ground);\n\n         var grid = new THREE.GridHelper(200, 20, 0x000000, 0x5b5b5b);\n         grid.position.set(0, 0, 0);\n         grid.material.opacity = 0.2;\n         grid.material.transparent = true;\n         this.scene.add(grid);\n\n         //---------------------------------------\n         //this.robot.create(0,80,80);\n         //this.robot.create(2,80,60);\n         //this.robot.move(2, -50, 50, ()=>{\n         //   this.robot.move(2, 0, 0);\n         //});\n\n         //this.robot.get_coordinates(2);\n\n         //---------------------------------------\n         //this.mqtt.publish('v1/localization/info', 'hello !');\n\n         // -------------------------------------\n\n         // onProgress callback\n         this.manager.onProgress = (item, loaded, total) => {\n            console.log(`${item}: ${loaded} ${total}`);\n         };\n\n         // Controls panel\n         this.gui.load(this, this.model.obj);\n\n         // All loaders done now\n         this.manager.onLoad = () => {\n            alert('Loaded');\n\n            // Set up interaction manager with the app now that the model is finished loading\n            new Interaction(this.renderer.threeRenderer, this.scene, this.camera.threeCamera, this.controls.threeControls);\n\n            // Add dat.GUI controls if dev\n            if (Config.isDev) {\n               this.meshHelper = new MeshHelper(this.scene, this.model.obj);\n               if (Config.mesh.enableHelper) this.meshHelper.enable();\n               this.gui.load(this, this.model.obj);\n            }\n\n            // Everything is now fully loaded\n            Config.isLoaded = true;\n            this.container.querySelector('#loading').style.display = 'none';\n         };\n      });\n\n      // Start render which does not wait for model fully loaded\n\n      this.render();\n      this.container.querySelector('#loading').style.display = 'none';\n   }\n\n   render() {\n      // Render rStats if Dev\n      if (Config.isDev && Config.isShowingStats) {\n         Stats.start();\n      }\n\n      // Call render function and pass in created scene and camera\n      this.renderer.render(this.scene, this.camera.threeCamera);\n\n      // rStats has finished determining render call now\n      if (Config.isDev && Config.isShowingStats) {\n         Stats.end();\n      }\n\n      // Delta time is sometimes needed for certain updates\n      //const delta = this.clock.getDelta();\n\n      // Call any vendor or module frame updates here\n      TWEEN.update();\n      this.controls.threeControls.update();\n\n      // RAF\n      requestAnimationFrame(this.render.bind(this)); // Bind the main class instead of window object\n   }\n}\n","import Config from './data/config';\nimport Detector from './utils/detector';\nimport Main from './app/main';\n\n// Styles\nimport './../css/app.scss';\n// Check environment and set the Config helper\nif(__ENV__ === 'dev') {\n   console.log('----- RUNNING IN DEV ENVIRONMENT! -----');\n   Config.isDev = true;\n}\n\nfunction init() {\n   // Check for webGL capabilities\n   if(!Detector.webgl) {\n      Detector.addGetWebGLMessage();\n   } else {\n      const container = document.getElementById('appContainer');\n      new Main(container);\n   }\n}\n\ninit();\n"],"sourceRoot":""}